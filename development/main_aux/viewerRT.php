<?php require_once "./class_dbase.php";  define('y4C544X3F',    1); define('y6Fe46X4G',    2); define('y0c547X4B',    3);  $TESTING = $_GET['TESTING']; $VER = $_GET['VER']; $SKIP = $_GET['SKIP']; $iPOSTS = $_GET['iPOSTS']; $bPOSTS = ($iPOSTS == 1); if($TESTING == 1) { $cf_button = '<link  href="../cssfiles/button.css" rel="stylesheet" type="text/css" />'; } else { $cf_button = "<link rel=\"stylesheet\" href=\"css/mpc.button.$VER.min.css\" type=\"text/css\" />"; } $db = new SQLite3('rt.db'); $xXcb167X9 = $db->query("SELECT COUNT (*) FROM wpitem;"); $row = $xXcb167X9->fetchArray(); $LINES = $row[0];  $xXcb167X9 = $db->query("SELECT dupcnt_t, dupcnt_s, errcnt_t, errcnt_s, dup_first, err_first FROM info;"); $row = $xXcb167X9->fetchArray(SQLITE3_ASSOC); $dupcnt = number_format($row['dupcnt_t'] + $row['dupcnt_s']); $errcnt = number_format($row['errcnt_t'] + $row['errcnt_s']); $dup_first = $row['dup_first']; $err_first = $row['err_first']; $dup_first_page = floor($dup_first/1000); $err_first_page = floor($err_first/1000); $emsg = ($errcnt == 0)? 'none' : 'block'; $dmsg = ($dupcnt == 0)? 'hidden' : 'visible';  $plink = ($bPOSTS)? 'Category/Slug' : 'Parent/Slug';  if($LINES < 1000) { $pndis = 'disabled="disabled"'; $iPages = 1; $currPage = 0; $nextPage = 0; $prevPage = 0; } else { $pndis = ''; $iPages = floor( ($LINES + 1000)/1000 ); $currPage = (isset($_GET['currPage']))? $_GET['currPage'] : 0; $prevPage = $currPage -1; if($prevPage < 0) $prevPage = $iPages -1; $nextPage = $currPage + 1; if($nextPage >= $iPages) $nextPage = 0; } $qs = "&TESTING=$TESTING&VER=$VER&SKIP=$SKIP&iPOSTS=$iPOSTS";  $etag = $dtag = '';  $x2 = ($err_first_page > 0)? 2 : 3; if( ($err_first % 1000) > $x2 ) $etag = '#a'.$err_first;  $x2 = ($dup_first_page > 0)? 2 : 3; if( ($dup_first % 1000) > $x2 ) $dtag = '#a'.$dup_first;  ?> <!DOCTYPE html> <html> <head> <meta charset="utf-8" /> <title>MPC - Article Report</title> <?php echo $cf_button ?> <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" ></script> <link rel="icon" type="image/png" href="images/favicon16.png" sizes="16x16"> <link rel="icon" type="image/png" href="images/favicon32.png" sizes="32x32">  <style type="text/css"> body { font-family:monospace; font-size:12.8px; margin:0; padding:0; color:black; background-color:white; cursor:wait; } .noitem {background-color:pink} .dupe {background-color:#ffec80} .noitem, .dupe { border-radius:5px; -moz-border-radius:5px; -webkit-border-radius:5px; } .dupes  { background-color:#ffec80; visibility:<?php echo $dmsg ?>; } .errors { background-color:pink; display:<?php echo $emsg ?>; } .dupes, .errors { font-family:Verdana,Arial,sans-serif; padding:1px 3px; margin:0 4px; border:1px solid #808080; border-radius:5px; -moz-border-radius:5px; -webkit-border-radius:5px; cursor:default; } a, a:link, a:visited {color:blue;text-decoration:none;} a:hover {text-decoration:underline} td {text-align:left;padding:0;white-space:nowrap;} .td_num {width:10px;text-align:right;} .div_num {margin:1px 0;padding:0 20px 0 10px} .div_url {padding:0 20px} .green {color:#008000;font-weight:bold} </style> <script>  jQuery(document).ready(function() { jQuery('body' ).css('cursor', 'default'); });  function busy(q) { jQuery('body' ).css('cursor', 'wait'); jQuery('.de' ).css('cursor', 'wait'); jQuery('.pnc' ).prop('disabled', true); var rnd = Math.random(); location.href='viewerRT.php?rnd='+rnd+'&currPage='+q; }  </script> </head> <body>  <div style="position:fixed;top:0;left:0;height:24px;width:100%;border-bottom:1px solid #808080;padding:7px 4px;background-color:#c4c4c4"> <table> <tr> <td> &nbsp;<button class="sexybutton sexyicononly pnc" <?php echo $pndis ?> title="Previous page of lines" onclick="busy('<?php echo $prevPage.$qs ?>')"> <span><span><span class="prev">&nbsp;</span></span></span></button> </td> <td> &nbsp;<button class="sexybutton sexyicononly pnc" <?php echo $pndis ?> title="Next page of lines" onclick="busy('<?php echo $nextPage.$qs ?>')"> <span><span><span class="next">&nbsp;</span></span></span></button> </td> <td> &nbsp;<button class="sexybutton pnc" title="Close listing" onclick="window.close();return false"><span><span><span class="cancel">Close</span></span></span></button> </td> <td> <b>&nbsp;&nbsp;Wordpress Article Report&nbsp;&nbsp;<?php echo number_format($LINES).' lines&nbsp;&nbsp;' ?></b> </td> <td> <div id="div_err" class="errors de" title="Click to display first error line: <?php echo number_format($err_first) ?>" onclick="busy('<?php echo $err_first_page.$qs.$etag ?>')">&nbsp;<?php echo $errcnt ?> Errors&nbsp;</div> </td> <td> <div id="div_dup" class="dupes de" title="Click to display first duplicate line: <?php echo number_format($dup_first) ?>" onclick="busy('<?php echo $dup_first_page.$qs.$dtag ?>')">&nbsp;<?php echo $dupcnt ?> Duplicates&nbsp;</div> </td>  </tr> </table> </div>  <?php echo '<table style="text-align:left">'; echo '<tr><td class="td_num"><div class="div_num">'.number_format($LINES).'</div></td>'; echo '<td><div style="height:44px"> </div></td></tr>';  $id1 = $currPage*1000; $id2 = $id1 + 999; if($id1 == 0) $id1 = 1; $res_path = $db->query("SELECT dest, varz_id FROM page WHERE id >= '$id1' AND id <= '$id2' ORDER BY id"); $res_wpitem = $db->query("SELECT title,spin,stat_t,stat_s FROM wpitem WHERE id >= '$id1' AND id <= '$id2' ORDER BY id");  $linecnt = ($currPage == 0)? 1 : 0;  while($row_path = $res_path->fetchArray(SQLITE3_ASSOC)) { $row_wpitem = $res_wpitem->fetchArray(SQLITE3_ASSOC); $title  = $row_wpitem['title']; $stat_t = $row_wpitem['stat_t']; $stat_s = $row_wpitem['stat_s']; $idnum = $currPage*1000+$linecnt++; $anum = $idnum+3; echo '<tr id="a'.$anum.'">'; $c = sprintf('%03d',$idnum); if($c > 999) echo '<td class="td_num"><div class="div_num">'.number_format($c).'</div></td>'; else echo '<td class="td_num"><div class="div_num">'.$c.'</div></td>';  if($stat_t == y6Fe46X4G) $title = '<span class="noitem">&nbsp;Title not found&nbsp;</span>'; else if($stat_t == y0c547X4B) $title = '<span class="noitem">&nbsp;Title contains html tags&nbsp;</span>'; else if($stat_t == y4C544X3F) $title = '<span class="dupe">&nbsp;'.$title.'&nbsp;</span>'; else $title = '&nbsp;'.$title.'&nbsp;'; $t  = '<span class="green">title:</span>'; $t .= '<a href="catAR.php?ar='.substr($row_path['dest'], $SKIP).'">'; $t .= $title; $t .= '</a>';  $vnum = $row_path['varz_id']; $res_var = $db->query("SELECT value FROM var WHERE id = '$vnum'"); $row_var = $res_var->fetchArray(SQLITE3_ASSOC); $xcab180X1 = $row_var['value'];   if($stat_s == y6Fe46X4G) $xcab180X1 = '<span class="noitem">&nbsp;Slug not found&nbsp;</span>'; else if($stat_s == y4C544X3F) $xcab180X1 = '<span class="dupe">&nbsp;'.$xcab180X1.'&nbsp;</span>'; else $xcab180X1 = '&nbsp;'.$xcab180X1.'&nbsp;';  $u  = '<span class="green">'.$plink.':</span>'; $u .= $xcab180X1;  $spin = $row_wpitem['spin']; if($spin < 0) { $a = 'never'; } else { switch ($spin) { case 0: $a = 'always'; break; case 1: $a = '1-day'; break; default: $a = $spin.'-days'; break; } } $s  = '<span class="green">autospin: </span>'.$a;  echo '<td>'.$t.'</td>'; echo '<td><div class="div_url">'.$u.'</div></td>'; echo '<td>'.$s.'</td>'; echo '</tr>'; } echo '</table>';  $db->close(); ?> </body> </html>
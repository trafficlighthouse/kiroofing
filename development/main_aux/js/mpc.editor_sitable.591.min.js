jQuery(document).ready(function(){$(function(){$(".dec").keyup(function(){if(this.value.match(/[^0-9]/g)){this.value=this.value.replace(/[^0-9]/g,"")}MpcSItable.stylePreview()})});$(function(){$(".hex").keyup(function(){if(this.value.match(/[^a-fA-F0-9]/g)){this.value=this.value.replace(/[^a-fA-F0-9]/g,"")}})});$(function(){$(".clss").keyup(function(){if(this.value.match(/[^a-zA-Z0-9_-]/g)){this.value=this.value.replace(/[^a-zA-Z0-9_-]/g,"")}})});$(function(){$(".chgs").change(function(){MpcSItable.stylePreview()})});$(function(){$(".chgk").change(function(){MpcSItable.statLinkOk();MpcSItable.stylePreview()})});$(function(){$("select.chgb").change(function(){MpcSItable.buildPreview()})});MpcSItable.initSI()});(function(k,c){var q={};var m,g="blue",f="blue",d="",n=["si_columns","si_case","si_class","si_width","si_bgnd_color","si_txt_align","si_hpadding","si_vpadding","si_spacing","si_link_ok","si_font_size","si_link_color","si_hover_color","si_brd_size","si_brd_collapse","si_brd_type","si_brd_color","yn_pcent","yn_nowrap","yn_hide0","yn_hide1","yn_hide2","yn_hide3","si_pre_color","cb_style","cb_short"];q.initSI=function(){m=false;var s=parent.oCodeMirror.getValue();var r="-";var u=s.search(/\<style title=".+?_table"/i);if(u!=-1){var t=s.search(/<\/head>/i);if(t!=-1){r=s.substring(u,t)}}var w=s.match(/\[mpc-shortcode: silo_table .*?\]/);var v=(w===null)?"-":w[0];MpcSItable.defaultSI(true);parent.MpcEditor.doAjax64("../ajax.php","ajax_readSI",true,{style:r,shortcode:v,def:d},function(x){if(x.charAt(0)=="{"){d=x}MpcSItable.loadSI();jQuery("#bnInstallSI").prop("disabled",false);q.selWhatClick();q.buildPreview();i()})};q.loadSI=function(){var t=jQuery.parseJSON(d);var r,s,u;for(r=0;r<n.length;r++){s=t[n[r]];if(n[r].charAt(0)=="s"){jQuery("#"+n[r]).val(s);continue}else{u=(s=="1");switch(n[r]){case"cb_style":jQuery("#cbStyle").prop("checked",u);break;case"cb_short":jQuery("#cbShort").prop("checked",u);break;case"yn_pcent":jQuery("#idYes4").toggleClass("fsel",u);jQuery("#idNo4").toggleClass("fsel",!u);break;case"yn_nowrap":jQuery("#idNoWrap").toggleClass("fsel",u);break;case"yn_hide0":case"yn_hide1":case"yn_hide2":case"yn_hide3":h=n[r].charAt(7);jQuery("#idYes"+h).toggleClass("fsel",u);jQuery("#idNo"+h).toggleClass("fsel",!u);break}}}t=jQuery("#si_link_color");t.css({backgroundColor:"#"+t.val(),color:l(t.val())});t=jQuery("#si_hover_color");t.css({backgroundColor:"#"+t.val(),color:l(t.val())});t=jQuery("#si_bgnd_color");t.css({backgroundColor:"#"+t.val(),color:l(t.val())});t=jQuery("#si_brd_color");t.css({backgroundColor:"#"+t.val(),color:l(t.val())});t=jQuery("#si_pre_color");t.css({backgroundColor:"#"+t.val(),color:l(t.val())});q.statLinkOk()};function p(s){var t={};var r,u;for(r=0;r<n.length;r++){if(n[r].charAt()=="s"){t[n[r]]=jQuery("#"+n[r]).val();continue}else{switch(n[r]){case"yn_pcent":u=jQuery("#idYes4").hasClass("fsel");break;case"yn_nowrap":u=jQuery("#idNoWrap").hasClass("fsel");break;case"yn_hide0":case"yn_hide1":case"yn_hide2":case"yn_hide3":h=n[r].charAt(7);u=jQuery("#idYes"+h).hasClass("fsel");break;case"cb_style":u=jQuery("#cbStyle").prop("checked");break;case"cb_short":u=jQuery("#cbShort").prop("checked");break}t[n[r]]=(u)?"1":"0"}}d=JSON.stringify(t);parent.MpcEditor.doAjax64("../ajax.php","ajax_writeSI",true,{mem_si:d},function(v){MpcSItable.installCB(s)})}q.resetSI=function(){q.defaultSI(false);q.loadSI();q.stylePreview()};q.defaultSI=function(s){var r;j={};j.si_width="100";j.yn_pcent="1";j.yn_nowrap="0";j.si_bgnd_color="FFFFFF";j.si_txt_align="center";j.si_hpadding="4";j.si_vpadding="0";j.si_spacing="4";j.si_link_ok="1";j.si_font_size="10pt";j.si_link_color="0000FF";j.si_hover_color="0000FF";j.si_brd_size="1";j.si_brd_collapse="0";j.si_brd_type="solid";j.si_brd_color="000000";if(!s){j.si_columns=jQuery("#si_columns").val();j.si_case=jQuery("#si_case").val();j.si_class=jQuery("#si_class").val();for(r=0;r<4;r++){j["yn_hide"+r]=(jQuery("#idYes"+r).hasClass("fsel"))?"1":"0"}j.si_pre_color=jQuery("#si_pre_color").val();j.cb_style=jQuery("#cbStyle").prop("checked");j.cb_short=jQuery("#cbShort").prop("checked")}else{j.si_columns="4";j.si_case="t";j.si_class="silo-";j.yn_hide0=0;j.yn_hide1=0;j.yn_hide2=0;j.yn_hide3=0;j.si_pre_color="FFFFFF";j.cb_style="1";j.cb_short="1"}d=JSON.stringify(j)};q.hideDiaStatusPink=function(){var r=jQuery(".dia-status");r.css("visibility","hidden");r.html("");jQuery(".epink").css("background-color","white");jQuery(".tdpink").css("background-color","transparent")};function e(s,t){var r=jQuery(".dia-status");r.html(t);if((s!="pink")&&(s!="lightgreen")){s="gold"}r.css({"background-color":s,visibility:"visible"})}function b(){parent.MpcEditor.closeSI()}function o(){jQuery("#ttlbusySI").toggleClass("busycss",true)}function i(){jQuery("#ttlbusySI").toggleClass("busycss",false)}q.installSI=function(){var t=q.selWhatClick();if(t=="none"){jQuery(".tdpink").css("background-color","pink");e("pink","No item selected to install");return}if(m){b()}var s=false;var r=jQuery("#si_class");if(r.val()==""){r.css("background-color","pink");s=true}if(t!="short"){r=jQuery("#si_width");if(r.val()==""){r.css("background-color","pink");s=true}r=jQuery("#si_hpadding");if(r.val()==""){r.css("background-color","pink");s=true}r=jQuery("#si_vpadding");if(r.val()==""){r.css("background-color","pink");s=true}r=jQuery("#si_spacing");if(r.val()==""){r.css("background-color","pink");s=true}r=jQuery("#si_brd_size");if(r.val()==""){r.css("background-color","pink");s=true}}if(s){e("pink","Required items cannot be blank");i();return}jQuery("#bnInstallSI").prop("disabled",true);o();p(t)};q.installCB=function(s){var v=jQuery.parseJSON(d);var u={};var r=JSON.stringify(u);var w;var A;var t;if(s!="style"){var x="";x+=v.si_columns+",";x+=v.si_class+"table,";x+=v.si_case+",";x+=(v.yn_hide0==1)?"1,":"0,";x+=(v.yn_hide1==1)?"1,":"0,";x+=(v.yn_hide2==1)?"1,":"0,";x+=(v.yn_hide3==1)?"1":"0";w=parent.MpcEditor.putShortSI("[mpc-shortcode: silo_table "+x+"]");if(w.substr(0,2)!="ok"){e("pink",w);jQuery("#bnInstallSI").prop("disabled",false);i();return}t=w.substr(3)}if(s!="short"){w=parent.MpcEditor.putStyleSI(a());if(w.substr(0,2)!="ok"){e("pink",w);jQuery("#bnInstallSI").prop("disabled",false);i();return}A=w.substr(3)}m=true;if(s=="short"){x="shortcode "+t}if(s=="style"){x="style "+A}if(s=="both"){x="style "+A+" and shortcode "+t}e("lightgreen",x);var y=jQuery("#bnExit");y.html("Close");y.toggleClass("accept",false);y.toggleClass("cancel",true);jQuery("#bnInstallSI").prop("disabled",false);jQuery("#table_sit").css("opacity","0.3");jQuery("#table_sit_preview").css("visibility","hidden");i()};function a(){var r=jQuery.parseJSON(d);var s=(r.yn_pcent=="1")?"%":"px";var t=(r.si_brd_collapse=="1")?"collapse":"separate";var u="";u+='<style title="silo_table" type="text/css">\n';u+="    ."+r.si_class+"table {\n";u+="        width:"+r.si_width+s+";\n";u+="        border-collapse:"+t+";\n";u+="        border-spacing:"+r.si_spacing+"px;\n";u+="    }\n";u+="    ."+r.si_class+"table td {\n";u+="        text-align:"+r.si_txt_align+";\n";u+="        background:#"+r.si_bgnd_color+";\n";u+="        padding:"+r.si_vpadding+"px "+r.si_hpadding+"px;\n";u+="        border:"+r.si_brd_size+"px "+r.si_brd_type+" #"+r.si_brd_color+";\n";if(r.yn_nowrap=="1"){u+="        white-space:nowrap;\n"}else{u+="        white-space:normal;\n"}u+="    }\n";if(r.si_link_ok==0){u+="/* begin link_no\n"}u+="    ."+r.si_class+"table a:link {\n";u+="        font-size:"+r.si_font_size+";\n";u+="        color:#"+r.si_link_color+";\n";u+="        text-decoration:none;\n";u+="    }\n";u+="    ."+r.si_class+"table a:visited {\n";u+="        color:#"+r.si_link_color+";\n";u+="        text-decoration:none;\n";u+="    }\n";u+="    ."+r.si_class+"table a:hover {\n";u+="        color:#"+r.si_hover_color+";\n";u+="        text-decoration:none;\n";u+="    }\n";u+="    ."+r.si_class+"table a:active {\n";u+="        color:#"+r.si_hover_color+";\n";u+="        text-decoration:none;\n";u+="    }\n";if(r.si_link_ok==0){u+="end link_no */\n"}u+="</style>\n";return u}q.buildPreview=function(){var s="Example Text";var y=jQuery("#si_case").val();if(y=="u"){s=s.toUpperCase()}else{if((y=="l")||(y=="a")){s=s.toLowerCase()}}var v=jQuery("#si_columns").val();var u=jQuery("#si_case").val();var r;var t=0;var w='<table id="mpc_table"><tr>';for(r=0;r<v;r++){w+='<td><div id="at'+t+'" class="atag" onmouseover = "MpcSItable.pover(this)"';w+='onmouseout="MpcSItable.pout(this)">'+s+"</div></td>";t++}w+="</tr><tr>";for(r=0;r<v;r++){w+='<td><div id="at'+t+'" class="atag" onmouseover = "MpcSItable.pover(this)"';w+='onmouseout="MpcSItable.pout(this)">'+s+"</div></td>";t++}w+="</tr></table>";jQuery("#previewbox").html(w);q.stylePreview()};q.stylePreview=function(){var x=jQuery("#si_width").val();var u=jQuery("#idYes4").hasClass("fsel")?"%":"px";var v=(jQuery("#si_brd_collapse").val()=="1")?"collapse":"separate";var s,r,y;var t=jQuery("#mpc_table");var w=jQuery("#previewbox");t.css("width",x+u);t.css("border-collapse",v);t.css("border-spacing",jQuery("#si_spacing").val()+"px");t=jQuery("#mpc_table td");s=jQuery("#si_brd_size").val();r=jQuery("#si_brd_type").val();y=jQuery("#si_brd_color").val();t.css("border",s+"px "+r+" #"+y);s="10pt";r="blue";y="blue";if(jQuery("#si_link_ok").val()==1){s=jQuery("#si_font_size").val();r="#"+jQuery("#si_link_color").val();y="#"+jQuery("#si_hover_color").val()}w.css({"font-size":s,color:r});jQuery(".atag").css("color",r);g=r;f=y;t.css("text-align",jQuery("#si_txt_align").val());s=jQuery("#si_vpadding").val();r=jQuery("#si_hpadding").val();y=jQuery("#si_bgnd_color").val();t.css("padding",s+"px "+r+"px");t.css("background-color","#"+y);s=jQuery("#idNoWrap").hasClass("fsel")?"nowrap":"normal";t.css("white-space",s);w.css("background-color","#"+jQuery("#si_pre_color").val())};function l(w){var t=parseInt(w,16);var v=(t>>16)&255;var u=(t>>8)&255;var s=t&255;v/=255;u/=255;s/=255;return 0.213*v+0.715*u+0.072*s<0.5?"#FFF":"#000"}q.pover=function(r){jQuery(r).css("color",f)};q.pout=function(r){jQuery(r).css("color",g)};q.selWhatClick=function(){var s=["none","style","short","both"];var t=0;var r=false;var u=false;if(jQuery("#cbStyle").prop("checked")){t+=1;r=true}if(jQuery("#cbShort").prop("checked")){t+=2;u=true}jQuery("#pin_style").toggleClass("pinsel",(r));jQuery("#pin_short").toggleClass("pinsel",(u));return s[t]};q.togOver=function(r){j=jQuery("#"+r);if(!j.hasClass("selok")){return}if(j.hasClass("sb-dis")){return}j.toggleClass("toghover",true)};q.togOut=function(r){jQuery("#"+r).toggleClass("toghover",false)};q.ynClicked=function(r){var t=jQuery("#idNo"+r);var s=jQuery("#idYes"+r);if(t.hasClass("sb-dis")||s.hasClass("sb-dis")){return}if(t.hasClass("selok")&&s.hasClass("selok")){if(t.hasClass("fsel")){t.toggleClass("fsel",false);s.toggleClass("fsel",true)}else{s.toggleClass("fsel",false);t.toggleClass("fsel",true)}}q.stylePreview()};q.tfClicked=function(t){var r=jQuery("#"+t);var s=r.hasClass("fsel");r.toggleClass("fsel",!s)};q.statLinkOk=function(){var r=(jQuery("#si_link_ok").val()==1);jQuery(".lnk").css("visibility",(r)?"visible":"hidden")};k.MpcSItable=q})(window);
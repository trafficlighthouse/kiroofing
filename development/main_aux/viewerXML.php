<?php require_once "./class_dbase.php";  $TESTING = $_GET['TESTING']; $VER = $_GET['VER']; $PERPAGE = $_GET['PERPAGE']; $DOM = str_replace('^', '.', $_GET['DOM']); $LINES = $_GET['LINES']; if($TESTING == 1) { $cf_button = '<link  href="../cssfiles/button.css" rel="stylesheet" type="text/css" />'; } else { $cf_button = "<link rel=\"stylesheet\" href=\"css/mpc.button.$VER.min.css\" type=\"text/css\" />"; }  if($LINES < $PERPAGE) { $pndis = 'disabled="disabled"'; $iPages = 1; $currPage = 0; $nextPage = 0; $prevPage = 0; } else { $pndis = ''; $iPages = floor( ($LINES + $PERPAGE)/$PERPAGE ); $currPage = (isset($_GET['currPage']))? $_GET['currPage'] : 0; $prevPage = $currPage -1; if($prevPage < 0) $prevPage = $iPages -1; $nextPage = $currPage + 1; if($nextPage >= $iPages) $nextPage = 0; } $qs = "&TESTING=$TESTING&VER=$VER&PERPAGE=$PERPAGE&DOM=$DOM&LINES=$LINES"; ?> <!DOCTYPE html> <html> <head> <meta charset="utf-8" /> <title>MPC - Xml Sitemap</title> <?php echo $cf_button ?> <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" ></script> <link rel="icon" type="image/png" href="images/favicon16.png" sizes="16x16"> <link rel="icon" type="image/png" href="images/favicon32.png" sizes="32x32">  <style type="text/css"> body { font-family:monospace; font-size:12.8px; margin:0; padding:0; color:black; background-color:white; } a, a:link, a:visited {color:blue;text-decoration:none;} a:hover {text-decoration:underline} td {text-align:left;padding:0;white-space:nowrap;} .td_num {width:10px;text-align:right;} .div_num {margin:1px 0;padding:0 20px 0 10px} </style> <script> function busy(q) { jQuery('.pnc' ).prop('disabled', true); location.href='viewerXML.php?currPage='+q; }  </script> </head> <body>  <div style="position:fixed;top:0;left:0;height:24px;width:100%;border-bottom:1px solid #808080;padding:7px 4px;background-color:#c4c4c4"> <table> <tr> <td> &nbsp;<button class="sexybutton sexyicononly pnc" <?php echo $pndis ?> title="Previous page of lines" onclick="busy('<?php echo $prevPage.$qs ?>')"> <span><span><span class="prev">&nbsp;</span></span></span></button> </td> <td> &nbsp;<button class="sexybutton sexyicononly pnc" <?php echo $pndis ?> title="Next page of lines" onclick="busy('<?php echo $nextPage.$qs ?>')"> <span><span><span class="next">&nbsp;</span></span></span></button> </td> <td> &nbsp;<button class="sexybutton pnc" title="Close listing" onclick="window.close();return false"><span><span><span class="cancel">Close</span></span></span></button> </td> <td> <b>&nbsp;&nbsp;XML Sitemap Test-only Viewer&nbsp;&nbsp;<?php echo number_format($LINES) ?>&nbsp;lines</b> </td> </tr> </table> </div>  <?php echo '<table style="text-align:left">'; echo '<tr><td class="td_num"><div class="div_num">'.number_format($LINES).'</div></td>'; echo '<td><div style="height:39px"> </div></td></tr>'; $db = new dbase('.', 'xml.db'); $db->dumpXmlPages($currPage, $currPage, $DOM, 'xml.txt', $PERPAGE); $db->close();  $xx2D3XA2F = fopen('./tmp/xml.txt', 'r'); $linecnt = ($currPage == 0)? 1 : 0; while(($line = fgets($xx2D3XA2F)) !== false) { echo '<tr>';  $c = sprintf('%03d',$currPage*$PERPAGE+$linecnt++); if($c > 999) echo '<td class="td_num"><div class="div_num">'.number_format($c).'</div></td>'; else echo '<td class="td_num"><div class="div_num">'.$c.'</div></td>';  echo '<td>'.htmlspecialchars($line).'</td>';  echo '</tr>'; } echo '</table>'; fclose($xx2D3XA2F); ?> </body> </html>
<?php $VER = '591'; $VER = '591'; define('TESTING',false); define('DEBUG',false); define('SPIN_NONE', 0); define('SPIN_NO',   1); define('PERM_ALL', 0); define('PERM_ALL1',1); define('PERM_ONE', 2);  @date_default_timezone_set(date_default_timezone_get()); x76F80Xef(); xE0F82XFb(); xc9E81X9b(); checkIfUpdated();  ye7f0k77d(); $x20F154X0 = xcAc83X77($arPhpVersion);   xaff84XxX(); x1Ba104X0();  $y1bc29Xb6 = xBG3109XB();   $xXEG1a7XG = $_SERVER['REQUEST_URI']; $pos = strpos($xXEG1a7XG,'?'); if($pos !== false) $xXEG1a7XG = substr($xXEG1a7XG,0,$pos); $x9Ba196Xc = $_SERVER['HTTP_HOST'];                $theDomainP = preg_replace('/^www\./i','',$x9Ba196Xc); $xbeF42Xd7 = pathinfo($xXEG1a7XG);                         $xF3X195XC = $xbeF42Xd7['dirname'];                 if($xF3X195XC == '/') { header('location: https://masspagecreator.com/ck/errpage.php?cmd=rfolder'); exit(); } $dotcnt = substr_count($xF3X195XC,'/');          $dotdot = str_repeat('../', $dotcnt);             $theWebRoot = __DIR__; for($x=0;$x<$dotcnt;$x++) { $theWebRoot = dirname($theWebRoot);            } $theFname = $xbeF42Xd7['basename'];                  $trimFname = $xbeF42Xd7['filename'];                 $theSname = $trimFname."_ini.php";                 $theAuxDir = $trimFname."_aux";                    $theMpcPath = __DIR__;                             $theAuxPath = __DIR__.'/'.$theAuxDir;              $xE47194XB = './'.$theFname;                       $thePath = $x9Ba196Xc.$xF3X195XC.'/';             $theFnameUrl = '//'.$thePath.$theFname;            $ar = explode('/',$xF3X195XC); $theFnameFld = $ar[count($ar)-1];                  $pos = strrpos($xF3X195XC,'/'); $x9FF198XE = substr($xF3X195XC,0,$pos+1);         $theParentUrl = trim($theDomainP.$x9FF198XE,'/');   $theZname = $trimFname.'_pclzip.php';               x4D8cX045($theZname); require_once $theZname; x4D9cX045(); if(isset($_GET['mpc'])) { switch(sha1($_GET['mpc'])) { case '448a99f9fa1422954a601cf6b4390534776853dd': ini_set('log_errors', 1); ini_set('error_log', 'error_log'); break;  case 'ede6e92a109f117563b20c8b6092f2aa84003553': if(file_exists('error_log')) unlink('error_log'); if(file_exists("$theAuxDir/error_log")) unlink("$theAuxDir/error_log"); if(file_exists("$theAuxDir/mpcerr_log")) unlink("$theAuxDir/mpcerr_log"); break;  case '85e82415d8d68c583d0846eed6ad9655fcb33112': $s = ""; if(file_exists('error_log')) $s .= "----- MPC/ -----\n" . file_get_contents('error_log')."\n"; if(file_exists("$theAuxDir/error_log")) $s .= "\n\n---- AUX/ ----\n" . file_get_contents("$theAuxDir/error_log")."\n"; if(file_exists("$theAuxDir/mpcerr_log")) $s .= "\n\n---- MPCERR ----\n" . file_get_contents("$theAuxDir/mpcerr_log")."\n"; header('Content-type:text/plain'); if($s == "") $s = 'no error logs found'; echo $s; exit(); } } set_error_handler("errorHandler");  if( (!TESTING) && (!class_exists('SQLite3', false)) ) { y0d02cXC6('sql'); exit(); }     $vFolder; $pjName; $xa532XF58 = ""; if(isset($_POST['mpc_ajax'])) { if(isset($_POST['cmd_ajax'])) { session_start(); $yBaA11X6G = @$_SESSION['ya532XF58']; $xa532XF58 = $_POST['cmd_ajax']; $xA91113X0 = json_decode( base64_decode( str_replace( array('-','_','.'),array('+','/','='), $_POST['data_ajax'] ) ), true ); switch($xa532XF58) { case 'aea919XDx': if($xA91113X0['def_tzone'] != '') { $ar = json_decode( file_get_contents("$theAuxDir/settings"), true); $ar['tzone'] = $xA91113X0['def_tzone']; file_put_contents("$theAuxDir/settings", json_encode($ar)); }  if($_SESSION['yABbaXE2G'] == "") { echo 'none'; break; } echo @urlencode($_SESSION['yABbaXE2G']); $_SESSION['yABbaXE2G'] = ""; break;  case 'j0dE1fXCF': $x1Af169X5 = time() . '-' .  @$_SESSION['yAGGbX2fe']; $x1Af169X5 = str_replace(".","-",$x1Af169X5); $x1Af169X5 = str_replace(":","",$x1Af169X5); $xEBD112X9 = (TESTING)? 1 : 0; $ltar = explode(':',@$_SESSION['yx4e8X66F']); if(count($ltar) == 3) $lt = $ltar[2]; else $lt = 'undefined';  $ar = array( 'win' => (x3X8daXD2() == 'Windows'), 'auxdir' => $theAuxDir, 'mpcpath' => $theMpcPath, 'theFname' => $theFname, 'theZname' => $theZname, 'trimFname' => $trimFname, 'theDomainP' => $theDomainP, 'theDomainPlo' => strtolower($theDomainP), 'theDomainPCaret' => str_replace('.', '^', $theDomainP), 'memlimit' => ini_get('memory_limit'), 'theDomain' => $x9Ba196Xc, 'theDomainCaret' => str_replace('.', '^', $x9Ba196Xc), 'email' => @$_SESSION['email'], 'emailCaret' => str_replace('.', '^', @$_SESSION['email']), 'theDirname' => $xF3X195XC, 'theWebRoot' => $theWebRoot, 'thePath' => $thePath, 'ver' => $VER, 'dotdot' => $dotdot, 'testing' => $xEBD112X9, 'php_version' => $x20F154X0, 'ixd' => $yBaA11X6G, 'r' => @$_SESSION['r'], 'i' => @$_SESSION['i'], 'dual' => @$_SESSION['dual'], 'iWlic' => @$_SESSION['wlic'], 'li' => @$_SESSION['yxec9XxDG'], 'lt' => substr($lt,1,2), 'iPhar' => (class_exists('PharData', false))? 1 : 0, 'ssl' => $_SESSION['ssl'], 'theFnameUrl' => $theFnameUrl, 'theFnameFld' => $theFnameFld, 'o' => @$_SESSION['o'], 'c' => @$_SESSION['c'], 'theParentUrl' => $theParentUrl, 'theSubdir' => $x9FF198XE, 'theSubdirTrim' => rtrim($x9FF198XE, '/'), 'theParentUrlCaret' => str_replace('.', '^', $theParentUrl), 'credDir' => $theAuxDir . '/tmp/' . $x1Af169X5 . '/' ); echo json_encode($ar); break;  case 'y4Df4dX6F': if(file_exists($theSname)) require($theSname); require_once "$theAuxDir/spin.php"; $ar = array( 'cmd' => 'readva', 'email' => $U, 'key' => $L, 'ver' => $VER );  xa457dXx0($ar, $out); echo $out; break;  case 'yfb052X8b': if(file_exists($theSname)) require($theSname); require_once "$theAuxDir/spin.php"; $ar = array( 'cmd' => 'writeva', 'email' => $U, 'key' => $L, 'idlist' => $xA91113X0['idlist'], 'vapatt' => $xA91113X0['vapatt'], 'ver' => $VER );  xa457dXx0($ar, $out); echo $out; break;  case 'jea919XDx': require_once "$theAuxDir/spin.php"; $ar = array( 'cmd' => 'testkey5', 'email' => $xA91113X0['email_ajax'], 'key' => $xA91113X0['key_ajax'], 'ver' => $VER );  xa457dXx0($ar, $out); echo $out; break;  case 'ajax_ininew5': require_once "$theAuxDir/spin.php"; $U=$P=$L=''; if(file_exists($theSname)) require($theSname);  $email = strtolower($xA91113X0['email_ajax']); $x704125X5   = md5(strtoupper($xA91113X0['key_ajax'])); $credDir = $xA91113X0['credDir_ajax']; $mesh = $xA91113X0['mesh_ajax']; $xfX0126X0 = md5(trim($xA91113X0['pw_ajax']));  $ar = array( 'cmd' => 'testkey5', 'email' => $xA91113X0['email_ajax'], 'key' => $xA91113X0['key_ajax'], 'log_key' => $L, 'ver' => $VER ); xa457dXx0($ar, $out);  $xAC063X21 = array('status'=>'ok', 'msg'=>'');  $rj = json_decode($out, true); if($rj['keyexist'] == 'no') { $xAC063X21['status'] = 'nokey'; echo json_encode($xAC063X21); break; }  if($mesh == 1) { if($rj['vakey'] != 1) { $xAC063X21['status'] = 'mesh_no_va'; echo json_encode($xAC063X21); break; } if( ($U == '') || ($L == '') || ($P == '') ) { $xAC063X21['status'] = 'mesh_no_creds'; echo json_encode($xAC063X21); break; }  if( $rj['vaowner'] != $rj['log_id'] ) { $xAC063X21['status'] = 'mesh_not_owner'; echo json_encode($xAC063X21); break; } } $xF0F1beXf = 0; if(!empty($rj['vanum'])) $xF0F1beXf = $rj['vanum'];  if(!file_exists($credDir)) mkdir($credDir,0777,true);  $xx85188XA = "<?php \$V='".$xF0F1beXf."';\$U='".$email."';\$P='".$xfX0126X0."';\$L='".$x704125X5."';"; if($mesh == 1) $xx85188XA .= "\$P1='".$P."';\$L1='".x150b4Xf3($L)."';\n"; file_put_contents($credDir.$theSname, $xx85188XA);  $zip = new PclZip($credDir.'credentials.zip'); $zip->create($credDir . $theSname, PCLZIP_OPT_REMOVE_PATH,$credDir); echo json_encode($xAC063X21); break;  case 'kbG41bX7E': require $theSname;  $_SESSION['dual'] = 0; if( !empty($P1) )  $_SESSION['dual'] = 1; if( ($P != md5($xA91113X0['pw_ajax'])) && (!empty($P1)) ) { $P = $P1; $L = x150b4Xf3($L1); $_SESSION['dual'] = 2; } $_SESSION['vnum'] = (empty($V))? 0 : $V;   $ar = array( 'cmd' => 'iniold5', 'email' => strtolower($xA91113X0['email_ajax']), 'key' => $L, 'ver' => $VER);  if(($U != $ar['email']) || ($P != md5($xA91113X0['pw_ajax']))) { echo 'Email or password incorrect'; break; } $_SESSION['ic'] = substr(md5($U.$L),0,16); file_put_contents("$theAuxDir/ic.php", "<?php \$saved_ic = '".$_SESSION['ic']."'; ?>");  $xF0F1beXf = xdfG133Xa('http://masspagecreator.com/ck/bin/zip/zip.db.zip'); file_put_contents("$theAuxDir/zip.db.zip", $xF0F1beXf); $zip = new PclZip("$theAuxDir/zip.db.zip"); $zip->extract(PCLZIP_OPT_PATH, "$theAuxDir", PCLZIP_OPT_REPLACE_NEWER); unlink("$theAuxDir/zip.db.zip");  $xx85188XA = ""; if(is_file("$theAuxDir/domlist")) { $ar = file("$theAuxDir/domlist",FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES); if(! empty($ar)) $xx85188XA = ','.implode(',',$ar); unlink("$theAuxDir/domlist"); } $ar['dom'] = $theDomainP.$xx85188XA; $ar['cdom'] = $theDomainP;  $arprm = array( 'cmd' => 'chkmul', 'email' => $U, 'key' => $L, 'ip' => $_SESSION['yAGGbX2fe'], 'dom' => $theDomainP); $_SESSION['prm'] = json_encode($arprm);  require_once "$theAuxDir/spin.php"; if(! xa457dXx0($ar, $out)) {  echo $out; break; }  $rj = json_decode($out, false);  if( empty($rj->dbid) ) $rj->dbid = 0; if($rj->keyexist == 'no') { echo 'Invalid License. Click \'New Credentials\' to install valid key.'; break; } switch($rj->stat) { case 'ok': $_SESSION['yxec9XxDG'] = ($rj->iustat == 'full')? 'no' : 'yes'; $_SESSION['email'] = $ar['email']; $_SESSION['yAxB7X09e'] = $L; $_SESSION['yx4e8X66F'] = $rj->stat.':'.$rj->lmsg.':'.$rj->vmsg; $_SESSION['ya532XF58'] = ($rj->vmsg == 'Demo')? 1 : 0; $_SESSION['dbid'] = $rj->dbid; $_SESSION['vaname'] = $rj->vaname; $_SESSION['r'] = $rj->r; $_SESSION['i'] = $rj->i; $_SESSION['o'] = (empty($rj->o))? 0:$rj->o; $_SESSION['c'] = (empty($rj->c))? 0:$rj->c; if($rj->vmsg == 'Demo') { $_SESSION['yABbaXE2G'] = json_encode(array('cmd'=>'dM')); break; }  if($rj->domstr != 'none') { $domcnt = substr_count($rj->domstr,',') +1; if($rj->lmsg == 'Licensed') $rj->lmsg = 'x'; $_SESSION['yABbaXE2G'] = json_encode(array('cmd'=>'dP', 'dbid'=>$rj->dbid, 'trig'=>$rj->trig, 'iudays'=>$rj->iudays, 'iustat'=>$rj->iustat, 'domstr'=>$rj->domstr, 'lmsg'=>$rj->lmsg, 'domcnt'=>$domcnt)); break; }     if(($rj->lmsg != 'Licensed') && ($rj->vmsg != 'Commercial')) { $_SESSION['yABbaXE2G'] = json_encode(array('cmd'=>'dEv', 'lmsg'=>$rj->lmsg)); } break;  case 'ng': $_SESSION['yxec9XxDG'] = 'yes'; $_SESSION['email'] = $xC79b2XX4; $_SESSION['yAxB7X09e'] = $L; $_SESSION['yx4e8X66F'] = $rj->stat.':'.$rj->lmsg.':'.$rj->vmsg; $_SESSION['ya532XF58'] = 1; $_SESSION['dbid'] = 0; $_SESSION['r'] = $rj->r; $_SESSION['i'] = $rj->i; $_SESSION['o'] = $rj->o; if($rj->lmsg == 'Subscription expired') $_SESSION['yABbaXE2G'] = json_encode(array('cmd'=>'dEx')); else $_SESSION['yABbaXE2G'] = json_encode(array('cmd'=>'dM')); break;  default: echo $rj->stat; break; } break;  case 'j0ca24XG9': require_once "$theAuxDir/spin.php"; $ar = array( 'cmd' => 'deact', 'email' => $xA91113X0['email_ajax'], 'key' => $xA91113X0['key_ajax'], 'ver' => $VER ); xa457dXx0($ar, $out); echo $out; break;  case 'j0A522XX0': require_once "$theAuxDir/spin.php"; $ar = array( 'cmd' => 'resetInUse', 'email' => $_SESSION['email'], 'key' => $_SESSION['yAxB7X09e'], 'ver' => $VER, 'dom' => strtolower($theDomainP) );  xa457dXx0($ar, $out); echo $out; break;  case 'k9ad1eXdD': $_SESSION['yABbaXE2G'] = json_encode(array('cmd'=>'dC')); break;  case 'a0C527XcC': require_once($theAuxDir.'/iccheck.php'); require_once "$theAuxDir/spin.php"; xfdd2aX04(0); $xAC063X21 = json_decode(file_get_contents("$theAuxDir/jsettings"),true);  if( ($xA91113X0['caller'] == 'project') || ($xA91113X0['caller'] == 'cf') ) { echo json_encode($xAC063X21); break; }  $xAC063X21['status']  = 'none'; $xAC063X21['isAreport']  = (file_exists($theAuxDir.'/rt.db'))? 'y' : 'n'; $xAC063X21['isBreport'] = (file_exists($theAuxDir.'/rh.db'))? 'y' : 'n'; $xAC063X21['isAzip'] = (file_exists($theAuxDir.'/article.zip'))? 'y' : 'n'; $xAC063X21['isAtar'] = (file_exists($theAuxDir.'/article.tar.gz'))? 'y' : 'n';  if($xA91113X0['caller'] == 'controller') $xF0F1beXf = y7c4a8X5c($p, PERM_ONE); else $xF0F1beXf = y7c4a8X5c($p);  if($p == 'x') break; if($xF0F1beXf != "") { echo $xF0F1beXf; } else { $xAC063X21['urlcount'] = $x9fEfcX8f; $xAC063X21['diskspace'] = diskSpace();  require $theAuxDir.'/s3settings.php'; $ar = json_decode($s3jstr, true); $xAC063X21['s3_key'] = $ar['key']; $xAC063X21['s3_secret'] = $ar['secret']; $xAC063X21['s3_region'] = $ar['region']; $xAC063X21['s3_wbucket'] = $ar['wbucket'];  $xAC063X21['path_first_item'] = ''; for($x=1; $x<6; $x++) { if(! empty($x0c547X4B['k'.$x][0]) ) { $xAC063X21['path_first'] = $x; $xAC063X21['path_first_item_raw'] = trim($x0c547X4B['k'.$x][0]); $xAC063X21['path_first_count'] = count($x0c547X4B['k'.$x]);      $xAC063X21['path_first_item'] = rtrim($x0c547X4B['k'.$x][0], '/'); break; } }  if( is_dir('mpc_short_files/v') ) { $ar = array(); $xF0F1beXf = 0; $DIR = opendir('mpc_short_files/v'); while($f = readdir( $DIR)) { if(preg_match('/^\d{4}$/',$f) != 1) continue; $ar[] = file_get_contents("mpc_short_files/v/$f/_if");  $xF0F1beXf++; } closedir($DIR); sort($ar); $ar = array_reverse($ar); for($x=0; $x<$xF0F1beXf; $x++) { $xAC063X21['v_if'.$x] = $ar[$x]; } } $xAC063X21['v_count'] = $xF0F1beXf; echo json_encode($xAC063X21); } break;  case 'ajax_updateVcomments': require_once($theAuxDir.'/iccheck.php'); $jobj = json_decode($xA91113X0['jcom'], true); $numstr = $jobj['nums']; $ar_nums = explode(',', $numstr); foreach($ar_nums as $fnum) { $xed5c8X67 = file_get_contents("mpc_short_files/v/$fnum/_if"); $fobj = json_decode($xed5c8X67, true); $fobj['name'] = $jobj[$fnum]; file_put_contents("mpc_short_files/v/$fnum/_if", json_encode($fobj)); } break;  case 'aE7b20XAc': require_once($theAuxDir.'/iccheck.php'); $dir = $xA91113X0['dir']; $xAC063X21 = y09a32X5D(trim($dir,'/')); if(empty($xAC063X21)) { echo 'none'; break; } echo implode("\t", $xAC063X21); break;  case 'k0A522XX0': require_once($theAuxDir.'/iccheck.php'); $xAxB7X09e = $xA91113X0['parm_ajax']; x0GFd5Xf0(); break;  case 'k0ca24XG9': require_once($theAuxDir.'/iccheck.php'); $xF0F1beXf = xdfG133Xa('https://masspagecreator.com/lists/pathlist500'); echo $xF0F1beXf; break;  case 'jFFX28XxX': require_once($theAuxDir.'/iccheck.php'); $fn = trim($xA91113X0['fname']); $fn = ltrim($fn,'/'); $xBxEc7XdA = 'https://masspagecreator.com/lists/' . str_replace(' ','%20',$fn); $znew = strtolower( trim( xdfG133Xa($xBxEc7XdA) ) );  if($xA91113X0['overw'] == 1) { file_put_contents($theAuxDir.'/snap/'.$xA91113X0['snapbox'], str_replace("\n", '\\n', $znew)); echo "$znew\n"; break; } else { $zold = ""; if( file_exists($theAuxDir.'/snap/'.$xA91113X0['snapbox']) ) $zold = file_get_contents($theAuxDir.'/snap/'.$xA91113X0['snapbox']); if($zold != "") $zold .= '\\n'; file_put_contents($theAuxDir.'/snap/'.$xA91113X0['snapbox'], $zold . str_replace("\n", '\\n', $znew));  if($zold != "") $zold = str_replace('\\n', "\n", $zold); echo "$zold$znew\n";  break; }  case 'a21F21X2d': require_once($theAuxDir.'/iccheck.php'); $fn = trim($xA91113X0['fn_ajax']); $xF0F1beXf = 'ok'; if(substr($fn,-1) == '/') { x60C9cX1b($fn); if(file_exists($fn)) $xF0F1beXf = 'folder'; } else { if(! unlink($fn)) $xF0F1beXf = 'file'; } echo $xF0F1beXf; break;  case 'ajax_testAddPhp': require_once($theAuxDir.'/iccheck.php'); testPhp($xAC063X21); echo json_encode($xAC063X21); break;  case 'ajax_enableAddPhp': require_once($theAuxDir.'/iccheck.php'); testPhp($xAC063X21); if( ($xAC063X21['html'] == 'pink') || ($xAC063X21['htm'] == 'pink') || ($xAC063X21['hxx'] == 'pink') ) { $at_stat = 'err'; if(xdfG133Xa('http://'.$thePath.$theAuxDir.'/test_htaccess/test_php/test.html') == 'ok') $at_stat = 'php'; else if(xdfG133Xa('http://'.$thePath.$theAuxDir.'/test_htaccess/test_php5/test.html') == 'ok') $at_stat = 'php5'; else if(xdfG133Xa('http://'.$thePath.$theAuxDir.'/test_htaccess/test_hand/test.html') == 'ok') $at_stat = 'hand'; else if(xdfG133Xa('http://'.$thePath.$theAuxDir.'/test_htaccess/test_ea/test.html') == 'ok') $at_stat = 'ea'; if($at_stat == 'err') { $xAC063X21['status'] = 'nophp'; echo json_encode($xAC063X21); break; }  $ext_str = ''; if($xAC063X21['html'] == 'pink') $ext_str .= ' .html'; if($xAC063X21['htm']  == 'pink') $ext_str .= ' .htm'; if($xAC063X21['hxx']  == 'pink') $ext_str .= ' '.$xA91113X0['tx_hxx'];  switch($at_stat) { case 'php': $at_str = 'addtype application/x-httpd-php'.$ext_str; break;  case 'php5': $at_str = 'addtype application/x-httpd-php5'.$ext_str; break;  case 'hand': $at_str = 'AddType application/x-httpd-php .php'.$ext_str; $at_str .= "\n"; $at_str .= 'AddHandler x-httpd-php .php'.$ext_str; break;  case 'ea': $at_str = 'AddType application/x-httpd-ea-php'.$pver.' .php .php5 .phtml'.$ext_str; break; }  $ht_file = $dotdot . '.htaccess'; if(! file_exists($ht_file)) { file_put_contents($ht_file, "$at_str\n"); } else { file_put_contents($ht_file,"\n$at_str\n", FILE_APPEND); } testPhp($xAC063X21); } echo json_encode($xAC063X21); break;  case 'j9AE26Xc0': require_once($theAuxDir.'/iccheck.php'); $xAC063X21 = array('status'=>'ok', 'linked'=>0); $bProject = ($xA91113X0['iProject'] == 1); $bGall = ($xA91113X0['iGall'] == 1);    $grabFolder = $xA91113X0['grabFolder']; $grabDest = trim($xA91113X0['grabDest'], '/'); $grabUrl = str_replace('^', '.', $xA91113X0['grabUrl']);  if(is_file($grabFolder)) { $xAC063X21['status'] = 'write_error'; $xAC063X21['msg'] = 'A <b>file</b> with the asset folder name exists'; echo json_encode($xAC063X21); break; }  $x0b37eX86 = curl_init($grabUrl); curl_setopt($x0b37eX86, CURLOPT_RETURNTRANSFER, 1); curl_exec($x0b37eX86); $hcode = curl_getinfo($x0b37eX86, CURLINFO_HTTP_CODE); curl_close( $x0b37eX86 ); if( ($hcode != '200') && ($hcode != '301') ) { $xAC063X21['status'] = 'read_error'; $xAC063X21['msg'] = 'File not found at this Url'; echo json_encode($xAC063X21); break; }  preg_match('#(https?://)([^/]+)(.*)#i', $grabUrl, $m); $grabDomainFQD = "$m[1]$m[2]";  $grabDomain = $m[2];            $endurl = $m[3];                  if( ($endurl == '') || ($endurl == '/' ) ) { $grabSubdir = ''; } else if( substr($endurl, -1) == '/') { $grabSubdir = trim($endurl, '/').'/'; } else { $endurl = trim($endurl, '/'); if($hcode == '200') { $pos = strrpos($endurl, '/'); if($pos === false) $grabSubdir = ''; else $grabSubdir = substr($endurl, 0, $pos).'/'; } else { $grabSubdir = $endurl.'/'; } }  $xC2XaaX5A = xdfG133Xa($grabUrl); if(! $xC2XaaX5A) { $xAC063X21['status'] = 'read_error'; $xAC063X21['msg'] = 'File read error'; echo json_encode($xAC063X21); break; }  if($bProject) { $gdest = "$grabFolder/$grabDest"; $xbFxd1Xb7 = dirname($gdest); if(! file_exists($xbFxd1Xb7)) mkdir($xbFxd1Xb7,0777,true); if((file_put_contents($gdest, $xC2XaaX5A)) === false) { $xAC063X21['status'] = 'write_error'; $xAC063X21['msg'] = 'Check website write permissions'; echo json_encode($xAC063X21); break; } } else { if($bGall) { $xF0F1beXf = getLinkedFiles($xC2XaaX5A); $xAC063X21['linked'] = $xF0F1beXf; }  $gdest = "$dotdot$grabDest"; $xbFxd1Xb7 = dirname($gdest); if(! file_exists($xbFxd1Xb7)) mkdir($xbFxd1Xb7,0777,true); if((file_put_contents($gdest, $xC2XaaX5A)) === false) { $xAC063X21['status'] = 'write_error'; $xAC063X21['msg'] = 'Check website write permissions'; echo json_encode($xAC063X21); break; } }  echo json_encode($xAC063X21); break;  case 'kea919XDx': require_once($theAuxDir.'/iccheck.php'); $tnum  = $xA91113X0['parm_tnum']; $xD8C192XA = $xA91113X0['parm_tdest']; $x0c71bdX5  = $xA91113X0['parm_yesf']; $xfF0135XX = 'http://masspagecreator.com/templates/mpc_'.$tnum; $xAC063X21 = array('stat' => 'dia', 'msg'=>'');  $manifest = xdfG133Xa($xfF0135XX.'/manifest'); if(preg_match('/^[sadg].._/', $manifest) != 1) { $xAC063X21['msg'] = 'Template not found'; echo json_encode($xAC063X21); break; }  if(is_file($xD8C192XA)) { $xAC063X21['msg'] = 'Cannot create folder. Named file exists'; echo json_encode($xAC063X21); break; } if( (is_dir($xD8C192XA)) && ($x0c71bdX5 != 1) ) { $xAC063X21['stat'] = 'exists'; echo json_encode($xAC063X21); break; }  if(! is_dir($xD8C192XA)) mkdir($xD8C192XA, 0777, true);  $str_snap = ""; $ar_man = explode("\n", trim($manifest)); foreach($ar_man as $line) { $fname = substr($line, 4);  if($line[0] == 'd') { if(! is_dir($xD8C192XA.'/'.$fname) ) mkdir($xD8C192XA.'/'.$fname, 0777, true); continue; }  $fdata = xdfG133Xa($xfF0135XX.'/'.$fname);  if($line[1] == 'r') $fdata = str_replace($xfF0135XX, $xF3X195XC.'/'.$xD8C192XA, $fdata);  file_put_contents("$xD8C192XA/$fname", $fdata); switch($line[0]) { case 's': $str_snap .= '\n'.$xD8C192XA.'/'.$fname; if($line[2] == 'i') $str_snap .= ' > index.html'; if($line[2] == 'f') $str_snap .= ' > '.$fname;    break;  case 'a': $str_snap .= '\n[asset] '.$xD8C192XA.'/'.$fname; break; } } file_put_contents($theAuxDir.'/snap/cp_taSource', substr($str_snap, 2)); $xAC063X21['stat'] = 'ok'; $xAC063X21['sbox'] = substr($str_snap, 2); $xAC063X21['msg1'] = 'Template import successful'; $xAC063X21['msg2'] = "<b>mpc_$tnum</b> imported to <b>$xF3X195XC/$xD8C192XA</b>"; echo json_encode($xAC063X21); break;   case 'kfcf1cXxf': require_once($theAuxDir.'/iccheck.php'); require_once "$theAuxDir/spin.php"; xfdd2aX04(0); if(file_exists("$theAuxDir/cancel")) unlink("$theAuxDir/cancel"); xbGCd7X1X(); $xAC063X21 = array('px' => -1); x5x88fXbe($xAC063X21); $xAC063X21['jsstr'] = file_get_contents("$theAuxDir/jsettings");  $xAC063X21['tstamp'] = getTimestamp($xA91113X0['tzone']);  echo json_encode($xAC063X21); break;    case 'kebF1dXC9': require_once($theAuxDir.'/iccheck.php'); getPostedPathsClean(); echo y6aA88X3A($xA91113X0['tzone']); break;  case 'kFFX29XxX': require_once($theAuxDir.'/iccheck.php'); require_once "$theAuxDir/spin.php"; $n = getPermCount($p); if($p == 'x') break; echo number_format((int)$n); break;  case 'ajax_prePathForm': require_once($theAuxDir.'/iccheck.php'); require_once($theAuxDir.'/build.php'); $xAC063X21 = array( 'asisurl'=>'', 'boxstr'=>''); $n = y970a9X8b($p, PERM_ONE); if($n != 0) { x2FF147X0($p, $xx5C14aXA, $x4c014fXC, $xAxB37X4A); $xAC063X21['asisurl'] = str_replace('//','/',trim($x4c014fXC,'/')); }  $ar_snapstr = array_fill(0,5,""); $ar_snapcnt = array_fill(0,5,0); $se = array("'",   '//\n', '/\n', '\n/'); $re = array("\\'", '\n',   '\n',  '\n');  for($x=1;$x<6;$x++) { if($x == $xA91113X0['curpath']) continue;  $s = (file_exists("$theAuxDir/snap/cp_taPath$x"))? file_get_contents("$theAuxDir/snap/cp_taPath$x") : ""; if(empty($s)) continue; $snf = trim($s, '/'); $snf = preg_replace('/\[.+?\]\s*/', '', $snf); $snf = str_replace($se, $re, $snf);  $ar_snapstr[$x-1] = str_replace('\n', "\t", $snf, $xdB78cXdE); $ar_snapcnt[$x-1] = $xdB78cXdE+1; } $xAC063X21['ar_snapcnt'] = $ar_snapcnt; $xAC063X21['ar_snapstr'] = $ar_snapstr;  $strbox = file_get_contents("$theAuxDir/snap/cp_taPath".$xA91113X0['curpath']); $ar_box = explode('\n', $strbox); $xAC063X21['totalcount'] = count($ar_box);  $xAC063X21['gtotal'] = 0; $ar_gbeg = array(1);  $strbox = preg_replace('/\[.+?\]\s*/', '', $strbox); $strbox = str_replace($se, $re, $strbox); $ar_strbox = explode('\n', $strbox);  for($x=0;$x<$xAC063X21['totalcount'];$x++) { if($x == $xAC063X21['totalcount']-1) { $xAC063X21['gtotal']++; $ar_gbeg[] = $x+2; continue; } if( strcasecmp( $ar_strbox[$x+1], $ar_strbox[$x] ) < 0 ) { $xAC063X21['gtotal']++; $ar_gbeg[] = $x+2; } } $xAC063X21['ar_gbeg'] = $ar_gbeg;  $num = 0; for($x=0;$x<$xAC063X21['totalcount'];$x++) { $num++; if(preg_match('/(\[.+?\])(.+)/', $ar_box[$x], $m) == 1) { $ar_box[$x] = '<div class="zx" id="zz'.$num.'"><span class="nu ff" id="nn'.$num.'">'.$num.'</span> <span id="ff'.$num.'" class="frm">'.$m[1].'</span> <b></b>'.trim($m[2]).'</div>'; } else { $ar_box[$x] = '<div class="zx" id="zz'.$num.'"><span class="nu" id="nn'.$num.'">'.$num.'</span> <b></b>'.trim($ar_box[$x]).'</div>'; } }  $xAC063X21['boxstr'] = implode('', $ar_box); echo json_encode($xAC063X21); break;  case 'kFFX30XxX': require_once($theAuxDir.'/iccheck.php'); require_once($theAuxDir.'/build.php'); $xAC063X21 = array( 'firsturl'=>'', 'firstdest'=>''); $n = y970a9X8b($p, PERM_ONE); if($n != 0) { $Project = json_decode(file_get_contents("$theAuxDir/jsettings")); $xAC063X21['jset_smap_remote_yn'] = $Project->smap_remote_yn; $xAC063X21['jset_smap_remote_url'] = $Project->smap_remote_url; x2FF147X0($p, $xx5C14aXA, $x4c014fXC, $xAxB37X4A); $xF0F1beXf = ($Project->lowurl_yn == 'yes'); if($xF0F1beXf) $xx5C14aXA = strtolower($xx5C14aXA); $xAC063X21['firsturl'] = str_replace('//','/',trim($xx5C14aXA,'/')); $xAC063X21['asisurl'] = str_replace('//','/',trim($x4c014fXC,'/'));  for($x=1;$x<6;$x++) { $v = ($xAxB37X4A[$x-1] == '*')? '' : $xAxB37X4A[$x-1]; $xAC063X21['asispath'.$x] = trim($v, '/'); if($xF0F1beXf) $v = strtolower($v); $v = trim($v, '/'); $xAC063X21['path'.$x] = $v; $xAC063X21['dashpath'.$x] = str_replace(' ', '-', $v); $xAC063X21['ynsilo'.$x] = ( strpos($xAxB37X4A[$x-1], '//') === false )? '' : 'yes'; }  if( ($xA91113X0['caller_ajax'] == 'formulaCr') || ($xA91113X0['caller_ajax'] == 'urlPreview') ) { $xAC063X21['firstdest'] = yC3a85XB5(); } } echo json_encode($xAC063X21); break;  case 'afcf1cXxf': require_once($theAuxDir.'/iccheck.php'); require_once($theAuxDir.'/build.php'); $Project = json_decode(file_get_contents("$theAuxDir/jsettings")); $str_gn = yc9E81X9b("#var=01:a#\t#var=02:a#\t#var=03:a#\t#var=04:a#\t#var=05:a#\t#var=06:a#\t#var=07:a#\t#var=08:a#\t#var=09:a#"); $arr_gn = array( 'lowurl_yn'       => $Project->lowurl_yn, 'smap_remote_yn'  => $Project->smap_remote_yn, 'smap_remote_url' => $Project->smap_remote_url ); $arr_gn['bcEndType'] = ''; $arr_gn['bcEndValue'] = ''; $arr_gn['sbox'] = ''; $xx85188XA = file_get_contents("$theAuxDir/snap/cp_taSource"); if($xx85188XA != '') { $arr_gn['sbox'] = sortSourceBoxCP($xx85188XA, $firstSrc); $arr_gn['bcEndValue'] = scanFirstDest(array($firstSrc), $bctype); $arr_gn['bcEndType'] = $bctype; } echo $str_gn . "\t" . json_encode($arr_gn); break;  case 'a0A522XX0': require_once($theAuxDir.'/iccheck.php'); require_once($theAuxDir.'/build.php'); xfdd2aX04(0); $proto = $xA91113X0['proto']; $projectF = $xA91113X0['projectF']; $Project = json_decode(file_get_contents("$theAuxDir/jsettings")); if($xA91113X0['mem_blue_caller'] == 'cf') break; $xF0F1beXf = y7c4a8X5c($p); if($p == 'x') break; if($xF0F1beXf != "") echo $xF0F1beXf; else xd11157X6($p); break;  case 'yEG154XF3': require_once($theAuxDir.'/iccheck.php'); require_once($theAuxDir.'/build.php'); xfdd2aX04(0); $xAC063X21['status']  = 'ok'; $xAC063X21['path_first'] = 0; $xAC063X21['path_first_item'] = ''; $xF0F1beXf = y7c4a8X5c($p); if($p == 'x') break; if($xF0F1beXf != "") { echo $xF0F1beXf; } else { $xAC063X21['urlcount'] = $x9fEfcX8f; $xAC063X21['path_first_item'] = ''; for($x=1; $x<6; $x++) { if(! empty($x0c547X4B['k'.$x][0]) ) { $xAC063X21['path_first'] = $x; $xAC063X21['path_first_item_raw'] = trim($x0c547X4B['k'.$x][0]); $xAC063X21['path_first_count'] = count($x0c547X4B['k'.$x]);      $xAC063X21['path_first_item'] = rtrim($x0c547X4B['k'.$x][0], '/'); break; } } echo json_encode($xAC063X21); } break;  case 'a0ca24XG9': $x0GB19aX1 = x70Bd9X0G(); require_once($theAuxDir.'/iccheck.php'); require_once($theAuxDir.'/build.php'); $proto = $xA91113X0['proto']; $projectF = $xA91113X0['projectF']; $x9fEfcX8f = $xA91113X0['iBlueTotal']; $x2f0c0XG1 = $xA91113X0['parm_gentype']; $isXml = (substr($x2f0c0XG1, 0, 3) == 'xml'); $y49C15XDe = $xA91113X0['iPostSelect']; if(! $isXml) y20D8aX50($xA91113X0['sett_ajax']); register_shutdown_function('fatalErrorHandler'); $xF0F1beXf = yece7fXCC(true); if($xF0F1beXf != '') { echo json_encode(array( 'status'=>'error', 'caption'=>'Blueprint error', 'msg'=>"Improper character (<b>$xF0F1beXf[0]</b>) found in Path $xF0F1beXf[1].<br />Please open the Project utility and click 'Clean Project'.", 'h'=>'133', 'w'=>'505' )); break; }  $buildLst = 'L'; if($isXml) $xeCdfdXf7 = ($yBaA11X6G == 1)? 10 : 0; else $xeCdfdXf7 = 0;  $bluelimit = 0; if($x2f0c0XG1 == 'html') $bluelimit = $xA91113X0['bluelimit']; $xdFG6cXB9 = false; openZipDb(); $xF0F1beXf = xGCea2XXE('diaBlue', $y49C15XDe, $x2f0c0XG1, "", 'none'); closeZipDb();  if($x72Ed0Xb1 != "") { echo $x72Ed0Xb1; break; } xfdd2aX04(0); if(! $isXml) yEf2a7XC3(); if($x72Ed0Xb1 != "") { echo $x72Ed0Xb1; break; } $xz = ( file_exists("$theAuxDir/xzipcode") )? 1:0; $xAC063X21 = array( 'status' => 'view', 'silod'  => $siloDepth, 'linecount' => $xF0F1beXf, 'xz' => $xz, 'bpTime' => xcXE146X0(x0X2d8Xe0($x0GB19aX1)) ); echo json_encode($xAC063X21); break;  case 'a8d92fXE0': $x0GB19aX1 = x70Bd9X0G(); require_once($theAuxDir.'/iccheck.php'); require_once($theAuxDir.'/build.php');  file_put_contents($theAuxDir.'/jsettings', $xA91113X0['jsett']);  $x9fEfcX8f = $xA91113X0['iBlueTotal']; register_shutdown_function('fatalErrorHandler'); $xAC063X21 = array(); $proto = $xA91113X0['proto']; $projectF = $xA91113X0['projectF']; $rad_rss = 'none'; $xAC063X21['rad_rss'] = $rad_rss; $ftype2 = $xA91113X0['ftype_ajax']; $x2f0c0XG1 = substr($ftype2, 0, 4); $y49C15XDe = $xA91113X0['iPostSelect']; $buildLst = $xA91113X0['buildLst_ajax']; $x8cx145Xc = $xA91113X0['pglim_ajax']; $exlist = $xA91113X0['exlist_ajax']; $xdFG6cXB9 = ($xA91113X0['unbuild_ajax'] == 1); y20D8aX50($xA91113X0['sett_ajax']); $bluelimit = $xA91113X0['buildlimit']; $iAuto = $xA91113X0['iAuto']; $bMin = $xA91113X0['bMin']; $bMax = $xA91113X0['bMax']; $x61C3fXA1 = explode(' ',$exlist); $xF0F1beXf = yece7fXCC(true); if($xF0F1beXf != '') { echo json_encode(array( 'status'=>'error', 'caption'=>'Build error', 'msg'=>"Improper character (<b>$xF0F1beXf[0]</b>) found in Path $xF0F1beXf[1].<br />Please open the Project utility and click 'Clean Project'.", 'h'=>'133', 'w'=>'505', 'pageCnt' => 0, 'dirCnt' => 0, 'elapsedTime' => x0X2d8Xe0($x0GB19aX1) )); break; }  $xeCdfdXf7 = (int)$x8cx145Xc; if($yBaA11X6G==1) { if(($xeCdfdXf7 == 0)||($xeCdfdXf7 > 10)) $xeCdfdXf7 = 10; }  if($buildLst == 'V') { if(! $xdFG6cXB9) { $vFolder = mt_rand(1000, 9999); while( file_exists("./mpc_short_codes/v/$vFolder") ) { $vFolder++; if($vFolder > 9999) $vFolder = 1000; } } }  openZipDb();  xGCea2XXE('diaBuild', $y49C15XDe, $x2f0c0XG1, $exlist, $rad_rss); closeZipDb(); $xAC063X21['bpCnt'] = $yAxB37X4A; if($x72Ed0Xb1 != "") { $xAC063X21 = json_decode($x72Ed0Xb1,true);     $xAC063X21['pageCnt'] = 0; $xAC063X21['dirCnt'] = 0; $xAC063X21['elapsedTime'] = x0X2d8Xe0($x0GB19aX1); echo json_encode($xAC063X21); break; }  if(! $xdFG6cXB9) { if(is_dir("$theAuxDir/tmp")) x60C9cX1b("$theAuxDir/tmp"); yEf2a7XC3(); if($x72Ed0Xb1 != "") { echo $x72Ed0Xb1; break; } prepareWebroot();  if(! $xdFG6cXB9) { if($Project->smap_yn == 'yes') file_put_contents("$theAuxDir/tmppass", serialize($xX944cXce)); $_SESSION['sod'] = $siloDepth; file_put_contents("$theAuxDir/tmppass1", serialize($x84e4eX9A)); } }  $pk = memory_get_usage(true); $mb = $pk / (1024*1024); if($mb < 1) $mb = 1; $pk = number_format($pk); $mb = number_format($mb,1); if(substr($mb,-2) == '.0') $mb = substr($mb,0,-2); $_SESSION['pk_blue'] = $pk; $_SESSION['mb_blue'] = $mb; $_SESSION['et_blue'] = x0X2d8Xe0($x0GB19aX1); xfdd2aX04(0);  $xAC063X21['vfolder'] = $vFolder; $xAC063X21['iAuto'] = $iAuto; $xAC063X21['bMin'] = $bMin; $xAC063X21['bMax'] = $bMax; $xAC063X21['status'] = 'ok'; echo json_encode($xAC063X21); break;  case 'aFFX28XxX': $x0GB19aX1 = x70Bd9X0G(); require_once($theAuxDir.'/iccheck.php'); require_once($theAuxDir.'/build.php'); $x9fEfcX8f = $xA91113X0['iBlueTotal'];  $rad_rss = 'none';  register_shutdown_function('fatalErrorHandler'); $xAC063X21 = array();  $ftype2 = $xA91113X0['ftype_ajax']; $proto = $xA91113X0['proto']; $projectF = $xA91113X0['projectF']; $x2f0c0XG1 = substr($ftype2, 0, 4); $y49C15XDe = $xA91113X0['iPostSelect']; $buildLst = $xA91113X0['buildLst_ajax']; $x8cx145Xc = $xA91113X0['pglim_ajax']; $exlist = $xA91113X0['exlist_ajax']; $xdFG6cXB9 = ($xA91113X0['unbuild_ajax'] == 1); $yAxB37X4A = $xA91113X0['bpCnt_ajax']; $vFolder = $xA91113X0['vfolder_ajax']; $iAuto = $xA91113X0['iAuto']; $bMin = $xA91113X0['bMin']; $bMax = $xA91113X0['bMax']; $pjName = $xA91113X0['pjName']; $urlS3 = $xA91113X0['urlS3']; $Project = json_decode(file_get_contents("$theAuxDir/jsettings"));  if($xdFG6cXB9) { x970a9X8b($fcnt,$dcnt,$scnt); $xAC063X21['status'] = 'unbuild_ok'; $xAC063X21['fcnt'] = $fcnt; $xAC063X21['dcnt'] = $dcnt; $xAC063X21['scnt'] = $scnt; if($x72Ed0Xb1 != "") { $xAC063X21['status'] = ($x72Ed0Xb1 == 'cancel')? 'unbuild_cancel' : 'unbuild_error'; $xAC063X21['msg'] = $x72Ed0Xb1; } $pk = memory_get_peak_usage(true); $mb = $pk / (1024*1024); if($mb < 1) $mb = 1; $pk = number_format($pk); $mb = number_format($mb,1); if(substr($mb,-2) == '.0') $mb = substr($mb,0,-2); $_SESSION['pk_build'] = $pk; $_SESSION['mb_build'] = $mb; $_SESSION['et_build'] = x0X2d8Xe0($x0GB19aX1);   $xAC063X21['pk_blue']  = $_SESSION['pk_blue']; $xAC063X21['pk_unbuild'] = $pk;  $xAC063X21['mb_blue']  = $_SESSION['mb_blue']; $xAC063X21['mb_unbuild'] = $mb;  $xAC063X21['et_blue']  = xcXE146X0($_SESSION['et_blue']); $tm = x0X2d8Xe0($x0GB19aX1); $xAC063X21['et_unbuild'] = xcXE146X0($tm);  $xAC063X21['et_total'] = xcXE146X0($_SESSION['et_blue'] + $tm); echo json_encode($xAC063X21); break; }  if(! $xdFG6cXB9) { if($Project->smap_yn == 'yes') $xX944cXce = unserialize(file_get_contents("$theAuxDir/tmppass")); $siloDepth = $_SESSION['sod']; $x84e4eX9A = unserialize(file_get_contents("$theAuxDir/tmppass1")); }  $x61C3fXA1 = explode(' ',$exlist); yece7fXCC(); $xeCdfdXf7 = (int)$x8cx145Xc; if($yBaA11X6G==1) { if(($xeCdfdXf7 == 0)||($xeCdfdXf7 > 10)) $xeCdfdXf7 = 10; } $xAC063X21 = array();  $x0GB19aX1 = x70Bd9X0G(); $yAxB37X4A = 0; if(! xE48a3XfC($urlS3, $exlist, $proto, $ftype2, $rad_rss)) { $xAC063X21['status'] = 'error'; if(substr($x72Ed0Xb1,0,6) == 'cancel') $xAC063X21['status'] = 'cancel'; if(substr($x72Ed0Xb1,0,6) == 'except') $xAC063X21['status'] = 'except'; $xAC063X21['msg'] = $x72Ed0Xb1; $xAC063X21['pageCnt'] = $yAxB37X4A; $xAC063X21['dirCnt'] = 0; $xAC063X21['elapsedTime'] = xcXE146X0(x0X2d8Xe0($x0GB19aX1)); if( ($buildLst == 'V') && (strlen($vFolder) == 4) ) { if(is_dir("mpc_short_files/v/$vFolder")) x60C9cX1b("mpc_short_files/v/$vFolder"); } echo json_encode($xAC063X21); break; }  xfdd2aX04(0); $xAC063X21['warning'] = (is_file("$theAuxDir/warning")) ? 1 : 0;  $xAC063X21['xzipcode'] = ( file_exists("$theAuxDir/xzipcode") )? 1:0;  $pk = memory_get_usage(true); $mb = $pk / (1024*1024); if($mb < 1) $mb = 1; $pk = number_format($pk); $mb = number_format($mb,1); if(substr($mb,-2) == '.0') $mb = substr($mb,0,-2);  if($x2f0c0XG1 == 'text') { $xAC063X21['status'] = 'text_ok'; $_SESSION['pk_build'] = $pk; $_SESSION['mb_build'] = $mb; $_SESSION['et_build'] = x0X2d8Xe0($x0GB19aX1); $xAC063X21['pageCnt'] = $yAxB37X4A; } else { $xAC063X21['status'] = 'html_ok'; $ar = array('L'=>' completed ', 'V'=>' completed ', 'C'=>' staged ', 'T'=>' compressed ');  if($ftype2 == 'htmlSO') { $msg = 'Build'.$ar[$buildLst].'Sitemaps (no pages)'; } else { $pt = ($buildLst == 'V')? ' Virtual Page' : ' HTML Page'; $msg = "Build".$ar[$buildLst].number_format($yAxB37X4A).$pt; $msg .= ($yAxB37X4A == 1)? '' : 's'; if($ftype2 == 'htmlPO') { $msg .= ' (no sitemaps)'; } else { $m = ($Project->smap_yn == 'yes')?  'with sitemaps' : 'no sitemaps'; $msg .= " ($m)"; } }  $xAC063X21['msg'] = $msg;  $xAC063X21['vFolder'] = $vFolder;  $xAC063X21['pageCnt'] = $yAxB37X4A;  if( ($Project->smap_yn == 'yes') && ($Project->smap_remote_yn == 'yes') ) { file_put_contents("$theAuxDir/domlist", $Project->smap_remote_url."\n", FILE_APPEND); } $xAC063X21['pk_blue']  = $_SESSION['pk_blue']; $xAC063X21['pk_build'] = $pk;  $xAC063X21['mb_blue']  = $_SESSION['mb_blue']; $xAC063X21['mb_build'] = $mb;  $xAC063X21['et_blue']  = xcXE146X0($_SESSION['et_blue']); $tm = x0X2d8Xe0($x0GB19aX1); $xAC063X21['et_build']  = xcXE146X0($tm); $xAC063X21['et_total'] = xcXE146X0($_SESSION['et_blue'] + $tm);  } if($buildLst == 'C') $xAC063X21['status'] = 'cloud_ok'; echo json_encode($xAC063X21); break;  case 'ajax_unbuildv': $x0GB19aX1 = x70Bd9X0G(); require_once($theAuxDir.'/iccheck.php'); require_once($theAuxDir.'/build.php'); register_shutdown_function('fatalErrorHandler'); $xAC063X21 = array();  $buildLst = 'V'; $vFolder = $xA91113X0['vfolder_ajax']; $Project = json_decode(file_get_contents("$theAuxDir/jsettings"));  x970a9X8b($fcnt,$dcnt,$scnt); $xAC063X21['status'] = 'ok_unbuildv'; $xAC063X21['fcnt'] = $fcnt; $xAC063X21['dcnt'] = $dcnt; $xAC063X21['scnt'] = $scnt;  $pk = memory_get_peak_usage(true); $mb = $pk / (1024*1024); $xAC063X21['pk_unbuild'] = $pk; $xAC063X21['mb_unbuild'] = $mb; $tm = x0X2d8Xe0($x0GB19aX1); $xAC063X21['et_unbuild'] = xcXE146X0($tm); echo json_encode($xAC063X21); break;  case 'y32G58XX9': $x0GB19aX1 = x70Bd9X0G(); require_once("$theAuxDir/iccheck.php"); require_once("$theAuxDir/s3settings.php"); $buildLst = $xA91113X0['buildLst']; $bucketname = $xA91113X0['theBucket']; $stagedir = ($xA91113X0['mem_writeto'] == 'ama_storage')? '/'.$bucketname : ''; $xAC063X21 = json_decode($xA91113X0['build_result'], true); $xAC063X21['status'] = 'ok_cloud'; $pgcnt = $xAC063X21['pageCnt']; $j3 = json_decode($s3jstr, true); $pcdiv = 100/$pgcnt;  require("$theAuxDir/aws/aws-autoloader.php"); $s3Client = Aws\S3\S3Client::factory(array( 'credentials' => array( 'key' => $j3['key'], 'secret' => $j3['secret'] ), 'region' => $xA91113X0['region'], 'version' => '2006-03-01' ));  $manager = new Aws\S3\Transfer($s3Client, "$theAuxDir/staging$stagedir", "s3://$bucketname", array( 'concurrency' => 20, 'before' => function(Aws\Command $command) { global $pcdiv, $theAuxDir;  static $pgdone = 0; static $pccur = 0; if($command->getName() == 'PutObject') { $command['ACL'] = 'public-read'; $pgdone++; $xF0F1beXf = floor($pgdone * $pcdiv);  if($xF0F1beXf > $pccur) { $pccur = $xF0F1beXf; file_put_contents("$theAuxDir/pcent", $pccur); } } } ) );  try { $manager->transfer(); } catch (Aws\S3\Exception\S3Exception $e) { $xAC063X21['status'] = 'ex_error'; $xAC063X21['msg'] = 'Have you selected the correct S3 Region?'; echo json_encode($xAC063X21); break; }   $msg = 'Build uploaded '.number_format($pgcnt).' Page'; $msg .= ($pgcnt == 1)? '' : 's'; $msg .= ' to Amazon S3 '; $msg .= ($xA91113X0['mem_writeto'] == 'ama_storage')? 'Storage' : 'Website'; $xAC063X21['msg'] = $msg; $xAC063X21['pageCnt'] = $pgcnt;  $pk = memory_get_peak_usage(true); $mb = $pk / (1024*1024); if($mb < 1) $mb = 1; $pk = number_format($pk); $mb = number_format($mb,1); if(substr($mb,-2) == '.0') $mb = substr($mb,0,-2); $xAC063X21['pk_cloud'] = $pk; $xAC063X21['mb_cloud'] = $mb;  $tm = x0X2d8Xe0($x0GB19aX1); $xAC063X21['et_cloud'] = xcXE146X0($tm); $xAC063X21['et_total'] = xcXE146X0($xAC063X21['et_total'] + $tm);  echo json_encode($xAC063X21); break;      case 'kFFX31XxX': $x0GB19aX1 = x70Bd9X0G(); require_once($theAuxDir.'/iccheck.php'); require_once($theAuxDir.'/build.php'); register_shutdown_function('fatalErrorHandler'); $xAC063X21 = array();  $yAxB37X4A = $xA91113X0['pageCnt']; $xAC063X21['itgz'] = $xA91113X0['itgz_ajax']; $xAC063X21['warning'] = $xA91113X0['warning_ajax']; $xAC063X21['xzipcode'] = $xA91113X0['xzipcode_ajax'];  if(! x98A1b9XC($yAxB37X4A, $xAC063X21['itgz'], $xAC063X21)) { yxe8a4XF8('text'); $xAC063X21['status'] = 'error'; if(substr($x72Ed0Xb1,0,6) == 'cancel') $xAC063X21['status'] = 'cancel'; if(substr($x72Ed0Xb1,0,6) == 'except') $xAC063X21['status'] = 'except'; $xAC063X21['msg'] = $x72Ed0Xb1; $xAC063X21['pageCnt'] = $yAxB37X4A;   $xAC063X21['bpCnt'] = $xA91113X0['pageCnt']; $xAC063X21['dirCnt'] = 0; $xAC063X21['elapsedTime'] = xcXE146X0(x0X2d8Xe0($x0GB19aX1)); echo json_encode($xAC063X21); break; }  $xAC063X21['status'] = 'ok_zip'; $msg = "Build completed ".number_format($yAxB37X4A)." TEXT Article"; $msg .= ($yAxB37X4A == 1)? '' : 's'; $xAC063X21['msg'] = $msg; $xAC063X21['pageCnt'] = $yAxB37X4A;   $pk = memory_get_usage(true); $mb = $pk / (1024*1024); if($mb < 1) $mb = 1; $pk = number_format($pk); $mb = number_format($mb,1); if(substr($mb,-2) == '.0') $mb = substr($mb,0,-2); $xAC063X21['pk_blue']  = $_SESSION['pk_blue']; $xAC063X21['pk_build']  = $_SESSION['pk_build']; $xAC063X21['pk_zip'] = $pk;  $xAC063X21['mb_blue']  = $_SESSION['mb_blue']; $xAC063X21['mb_build']  = $_SESSION['mb_build']; $xAC063X21['mb_zip'] = $mb;  $xAC063X21['et_blue']  = xcXE146X0($_SESSION['et_blue']); $xAC063X21['et_build']  = xcXE146X0($_SESSION['et_build']);  $tm = x0X2d8Xe0($x0GB19aX1); $xAC063X21['et_zip']  = xcXE146X0($tm); $xAC063X21['et_total'] = xcXE146X0($_SESSION['et_blue'] + $_SESSION['et_build'] + $tm);  echo json_encode($xAC063X21); break;  case 'aebF1dXC9': require_once($theAuxDir.'/iccheck.php'); if($xA91113X0['parm_ajax'] == 'all') { chdir('../'); x60C9cX1b($theFnameFld); echo 'all'; } else { removeSources();  $xx85188XA = file_get_contents("$theAuxDir/spin.php"); $xF0F1beXf = strpos($xx85188XA, 'RUNTIME'); file_put_contents("$theAuxDir/spin.php", substr($xx85188XA, 0, $xF0F1beXf-2)); $dh = opendir($theAuxDir); while( ($file = readdir($dh)) !== false ) { if( ($file == '.') || ($file == '..') ) continue; if($file == 'rsa_login') continue; if($file == 'spin.php') continue; if($file == 'bin') continue; if($file == 'vt') continue; if( is_dir("$theAuxDir/$file") ) { x60C9cX1b("$theAuxDir/$file"); continue; } else if( is_file("$theAuxDir/$file") ) { unlink("$theAuxDir/$file"); continue; } } closedir($dh); if(is_dir('.Backup-Files')) x60C9cX1b('.Backup-Files'); unlink($theSname); unlink($theFname); if(file_exists($theZname)) unlink($theZname); if(file_exists('pclzip.lib.php')) unlink('pclzip.lib.php'); echo 'some'; } break;  } } exit(); }   function removeSources() { global $theAuxDir;  if(! file_exists("$theAuxDir/snap/cp_taSource")) return false; $cps = file_get_contents("$theAuxDir/snap/cp_taSource"); if($cps == '') return false;  $x0XC64XFb = explode('\n', $cps); foreach($x0XC64XFb as $s) { if(preg_match('/^\[\s*(?:asset|webroot)\s*\](.*)/i', $s, $m) == 1) continue;  if(preg_match('/^\[\s*group.*?\](.*?)>/i', $s, $m) == 1) { removeIf($m[1]); continue; }  if(preg_match('/^\[\s*group.*?\](.*)/i', $s, $m) == 1) { removeIf($m[1]); continue; }  if(preg_match('/^\[\s*(index|file)\s*=\s*\w+\]\s*(.*?)>.*/i', $s, $m) == 1) { removeIf($m[2]); continue; }  if(substr($s, 0, 9) == '[default]') $s = substr($s, 9);  if(preg_match('/^\s*(.*?)\s*>.*/', $s, $m) == 1) { removeIf($m[1]); continue; }  if(preg_match('/^\[\s*(index|file)\s*=\s*\w+\](.*)$/i', $s, $m) == 1) { removeIf($m[2]); continue; }  removeIf($s); } }   function removeIf($fn) { $xx85188XA = trim($fn); if($xx85188XA == "") return; if(! file_exists($xx85188XA) ) return; unlink($xx85188XA); $pos = strpos($xx85188XA, '/'); if($pos === false) return; if($pos == 0) return; $dir = substr($xx85188XA, 0, $pos);  $dh= opendir($dir); while (false !== ($xefXb5X80 = readdir($dh))) { if ($xefXb5X80 != "." && $xefXb5X80 != "..") { closedir($dh); return; } } $dh= closedir($dir); rmdir($dir); }   function getLinkedFiles(&$xC2XaaX5A) { global $grabFolder, $grabDomain, $grabDomainFQD, $grabSubdir, $dotdot, $ar_wfiles, $ar_bgfiles, $link_file_count, $csspath;  $ar_wfiles = array(); $ar_bgfiles = array(); $link_file_count = 0;  $xed5c8X67 = preg_replace( array('/\<link [^\>]*?rel=([\'\"])(canonical|shortlink)\\1[^\<]*?\>/i', '/\<meta [^\>]*?property=([\'\"])og:url\\1[^\<]*?\>/i'), '', $xC2XaaX5A);   $ps = 'script|link|img';  $xed5c8X67 = preg_replace_callback("/(<$ps)([^>]+)(href=|src=)([\"\'])(https?:(?:\/\/|\/\/www\.)$grabDomain\/|\/\/$grabDomain\/|\/\/www\.$grabDomain\/|.)(.*?)\\4(.*?)>/i", function($m) { global $grabFolder, $grabSubdir, $ar_wfiles;   if( strlen($m[5]) > 1 ) { if(! get_arq($m[6], $arq) ) return "$m[0]"; $ar_wfiles[] = $arq['path']; return "$m[1]$m[2]$m[3]$m[4]/$grabFolder/" . $arq['pathx'] . $arq['query'] . $arq['fragment'] . $m[4] . $m['7'] . '>'; }  if( preg_match('#^(//|http://|https://|data:)#i', "$m[5]$m[6]") == 1) return "$m[0]"; if($m[5] == '/') { if(! get_arq($m[6], $arq) ) return "$m[0]"; $ar_wfiles[] = $arq['path']; return "$m[1]$m[2]$m[3]$m[4]/$grabFolder/" . $arq['pathx'] . $arq['query'] . $arq['fragment'] . $m[4] . $m['7'] . '>'; } else { if(! get_arq("$m[5]$m[6]", $arq) ) return "$m[0]"; $ar_wfiles[] = $grabSubdir . $arq['path']; return "$m[1]$m[2]$m[3]$m[4]/$grabFolder/$grabSubdir" . $arq['pathx'] . $arq['query'] . $arq['fragment'] . $m[4] . $m['7'] . '>'; } }, $xed5c8X67 );   $ps = 'img'; $xed5c8X67 = preg_replace_callback("/(<$ps)([^>]+)(srcset=)([\"\'])(.+?)\\4(.*?)>/i", function($m) { global $grabDomain, $grabFolder, $grabSubdir, $ar_wfiles, $sz;   $newstr = ''; $ar = explode(',', $m[5]); $xdB78cXdE = count($ar);  for($x=0; $x<$xdB78cXdE; $x++) { $pair = trim($ar[$x]); $pos = strpos($pair, ' '); if($pos !== false) { $so = substr($pair, 0, $pos); $sz = substr($pair, $pos+1); } else { $so = substr($pair); $sz = ''; }  $newstr .= preg_replace_callback("/(https?:(?:\/\/|\/\/www\.)$grabDomain\/|\/\/$grabDomain\/|\/\/www\.$grabDomain\/|.)(.+)/i",  function($n) { global $sz, $grabFolder, $grabSubdir, $ar_wfiles;   if( strlen($n[1]) > 1 ) { if(! get_arq($n[2], $arq) ) return "$n[0] $sz,"; $ar_wfiles[] = $arq['path']; return "/$grabFolder/" . $arq['pathx'] . $arq['query'] . $arq['fragment'] . ' ' . $sz . ','; } if( preg_match('#^(//|http://|https://|data:)#i', "$n[1]$n[2]") == 1) return "$n[0] $sz,"; if($n[1] == '/') { if(! get_arq($n[2], $arq) ) return "$n[0] $sz,"; $ar_wfiles[] = $arq['path']; return "/$grabFolder/" . $arq['pathx'] . $arq['query'] . $arq['fragment'] . ' ' . $sz . ','; } else { if(! get_arq("$n[1]$n[2]", $arq) ) return "$n[0] $sz,"; $ar_wfiles[] = $grabSubdir . $arq['path']; return "/$grabFolder/$grabSubdir" . $arq['pathx'] . $arq['query'] . $arq['fragment'] . ' ' . $sz . ','; } }, $so );   } return "$m[1]$m[2]$m[3]$m[4]".trim($newstr, ',')."$m[4]$m[6]>"; }, $xed5c8X67 );   $xed5c8X67 = preg_replace_callback("/<meta[^>]+property=[\'\"]og:image\W[^>]+>/i", function($m) { global $grabFolder, $grabDomain, $grabSubdir, $ar_wfiles;  $xF0F1beXf = preg_match("/<meta([^>]+)content=([\'\"])(https?:(?:\/\/|\/\/www\.)$grabDomain\/|\/\/$grabDomain\/|\/\/www\.$grabDomain\/|.)(.*?)\\2(.*?)>/i", $m[0], $mm); if($xF0F1beXf != 1) return $m[0];  if( strlen($mm[3]) > 1 ) { if(! get_arq($mm[4], $arq) ) return "$m[0]"; $ar_wfiles[] = $arq['path']; return "<meta$mm[1]content=$mm[2]/$grabFolder/" . $arq['pathx'] . $arq['query'] . $arq['fragment'] . "$mm[2]$mm[5]" . '>'; }  if( preg_match('#^(//|http://|https://|data:)#i', "$mm[3]$mm[4]") == 1) return "$m[0]"; if($mm[3] == '/') { if(! get_arq($mm[4], $arq) ) return "$m[0]"; $ar_wfiles[] = $arq['path']; return "<meta$mm[1]content=$mm[2]/$grabFolder/" . $arq['pathx'] . $arq['query'] . $arq['fragment'] . "$mm[2]$mm[5]" . '>'; } else { if(! get_arq("$mm[3]$mm[4]", $arq) ) return "$m[0]"; $ar_wfiles[] = $grabSubdir . $arq['path']; return "<meta$mm[1]content=$mm[2]/$grabFolder/$grabSubdir" . $arq['pathx'] . $arq['query'] . $arq['fragment'] . "$mm[2]$mm[5]" . '>'; } }, $xed5c8X67 );  $csspath = '';  $xC2XaaX5A = preg_replace_callback("/(\W)url\(([ \"\']*)(https?:(?:\/\/|\/\/www\.)$grabDomain\/|\/\/$grabDomain\/|\/\/www\.$grabDomain\/|.)(.*?)\)/i", 'css_callback', $xed5c8X67);  $xAC063X21 = array_unique($ar_wfiles);  foreach($xAC063X21 as $f) { $xd30cfX96 = preg_replace('#^(wp-includes/|wp-content/)#', '', "$f");  if(! file_exists(dirname("$dotdot$grabFolder/$xd30cfX96")) ) mkdir(dirname("$dotdot$grabFolder/$xd30cfX96"), 0777, true); if( strcasecmp(pathinfo($f, PATHINFO_EXTENSION), 'css') != 0 ) {  $xF0F1beXf = xdfG133Xa("$grabDomainFQD/$f"); if($xF0F1beXf) { $link_file_count++; file_put_contents("$dotdot$grabFolder/$xd30cfX96", $xF0F1beXf); } } else { $c = xdfG133Xa("$grabDomainFQD/$f"); if($c) { $csspath = dirname($f); $xF0F1beXf = preg_replace_callback("/(\W)url\(([ \"\']*)(https?:(?:\/\/|\/\/www\.)$grabDomain\/|\/\/$grabDomain\/|\/\/www\.$grabDomain\/|.)([^:]*?)\\2\)/i", 'css_callback', $c); $link_file_count++; file_put_contents("$dotdot$grabFolder/$xd30cfX96", $xF0F1beXf); } } }   if( count($ar_bgfiles) > 0) { $xAC063X21 = array(); $xAC063X21 = array_unique($ar_bgfiles); $xAC063X21 = array_diff( $xAC063X21, $ar_wfiles); $ar_bgfiles = array(); foreach($xAC063X21 as $f) { $xd30cfX96 = preg_replace('#^(wp-includes/|wp-content/)#', '', "$f");  if(! file_exists(dirname("$dotdot$grabFolder/$xd30cfX96")) ) mkdir(dirname("$dotdot$grabFolder/$xd30cfX96"), 0777, true); $xF0F1beXf = xdfG133Xa("$grabDomainFQD/$f"); if($xF0F1beXf) { if( strcasecmp(pathinfo($f, PATHINFO_EXTENSION), 'css') != 0 ) { file_put_contents("$dotdot$grabFolder/$xd30cfX96", $xF0F1beXf); $link_file_count++; } else { $csspath = dirname($f); $c = preg_replace_callback("/(\W)url\(([ \"\']*)(https?:(?:\/\/|\/\/www\.)$grabDomain\/|\/\/$grabDomain\/|\/\/www\.$grabDomain\/|.)([^:]*?)\\2\)/i", 'css_callback', $xF0F1beXf); file_put_contents("$dotdot$grabFolder/$xd30cfX96", $c); $link_file_count++; } } }   $xAC063X21 = array(); $xAC063X21 = array_unique($ar_bgfiles); foreach($xAC063X21 as $f) { $xd30cfX96 = preg_replace('#^(wp-includes/|wp-content/)#', '', "$f");  if(! file_exists(dirname("$dotdot$grabFolder/$xd30cfX96")) ) mkdir(dirname("$dotdot$grabFolder/$xd30cfX96"), 0777, true); $xF0F1beXf = xdfG133Xa("$grabDomainFQD/$f"); if($xF0F1beXf) { file_put_contents("$dotdot$grabFolder/$xd30cfX96", $xF0F1beXf); $link_file_count++; } } } return $link_file_count; }   function css_callback($m) { global $grabFolder, $ar_bgfiles, $csspath, $grabSubdir;   if( strlen($m[3]) > 1 ) { if(! get_arq($m[4], $arq) ) return "$m[0]"; $ar_bgfiles[] = $arq['path']; return "$m[1]url($m[2]/$grabFolder/" . $arq['pathx'] . $arq['query'] . $arq['fragment'] . $m[2] . ')'; }  if( preg_match('#^(//|http://|https://|data:)#i', "$m[3]$m[4]") == 1) return "$m[0]"; if($m[3] == '/') { if(! get_arq($m[4], $arq) ) return "$m[0]"; $ar_bgfiles[] = $arq['path']; return "$m[1]url($m[2]/$grabFolder/" . $arq['pathx'] . $arq['query'] . $arq['fragment'] . $m[2] . ')'; } else { if(! get_arq("$m[3]$m[4]", $arq) ) return "$m[0]";  $p3 = $arq['path']; $cssp = $csspath; $xdB78cXdE = substr_count($p3, '../'); if($xdB78cXdE > 0) { for($x=0;$x<$xdB78cXdE;$x++) { $cssp = dirname($cssp); $p3 = substr($p3, 3); } } if($cssp == '.') $cssp = ''; if($cssp != '') $cssp = "$cssp/"; $ar_bgfiles[] = "$cssp$p3"; $csp3 = preg_replace('#^(wp-includes/|wp-content/)#', '', "$cssp$p3"); return "$m[1]url($m[2]/$grabFolder/$csp3" . $arq['query'] . $arq['fragment'] . $m[2] . ')'; } }   function get_arq($inp, &$ar) { $ar = parse_url($inp); if(empty($ar['path'])) return false; $xAC063X21 = pathinfo($ar['path']); if(empty($xAC063X21['extension'])) return false; if( strcasecmp($xAC063X21['extension'], 'php') == 0 ) return false; if( strcasecmp($xAC063X21['extension'], 'xml') == 0 ) return false; $ar['dirname'] = $xAC063X21['dirname']; $ar['basename'] = $xAC063X21['basename']; $ar['extension'] = $xAC063X21['extension']; $ar['query'] = ( empty($ar['query']) )? '' : '?'.$ar['query']; $ar['fragment'] = ( empty($ar['fragment']) )? '' : '#'.$ar['fragment']; $ar['pathx'] = preg_replace('#^(wp-includes/|wp-content/)#', '', $ar['path']); return true; }  function testPhp(&$xAC063X21) { global $thePath, $theAuxDir, $xA91113X0;  $xAC063X21 = array('status' => 'file_ok', 'html'=>'transparent', 'htm'=>'transparent', 'hxx'=>'transparent'); if($xA91113X0['cb_html'] != 0) { $xAC063X21['html'] = (xdfG133Xa('http://'.$thePath.$theAuxDir.'/test_htaccess/test.html') == 'ok')? 'lightgreen':'pink'; } if($xA91113X0['cb_htm'] != 0) { $xAC063X21['htm'] = (xdfG133Xa('http://'.$thePath.$theAuxDir.'/test_htaccess/test.htm') == 'ok')? 'lightgreen':'pink';   } if( ($xA91113X0['cb_hxx'] != 0) && ($xA91113X0['tx_hxx'] != '') ) { if(! file_exists($theAuxDir.'/test_htaccess/test'.$xA91113X0['tx_hxx']) ) { copy($theAuxDir.'/test_htaccess/test.html', $theAuxDir.'/test_htaccess/test'.$xA91113X0['tx_hxx']); copy($theAuxDir.'/test_htaccess/test.html', $theAuxDir.'/test_htaccess/test_php/test'.$xA91113X0['tx_hxx']); copy($theAuxDir.'/test_htaccess/test.html', $theAuxDir.'/test_htaccess/test_php5/test'.$xA91113X0['tx_hxx']); copy($theAuxDir.'/test_htaccess/test.html', $theAuxDir.'/test_htaccess/test_hand/test'.$xA91113X0['tx_hxx']); copy($theAuxDir.'/test_htaccess/test.html', $theAuxDir.'/test_htaccess/test_ea/test'.$xA91113X0['tx_hxx']); } $xAC063X21['hxx'] = (xdfG133Xa('http://'.$thePath.$theAuxDir.'/test_htaccess/test'.$xA91113X0['tx_hxx']) == 'ok')? 'lightgreen':'pink'; } }  $x1bc29Xb6;$x07A18bXA;$strPathLab;  function yece7fXCC($testpath = false) { global $x1bc29Xb6,$xEG154XF3,$x07A18bXA,$strPathLab;  $xF0F1beXf = xbGCd7X1X($testpath); if($testpath && ($xF0F1beXf != '')) return $xF0F1beXf;  $x1bc29Xb6 = y76F80Xef('taSource');  for($x=1;$x<10;$x++) { $xEG154XF3['k'.$x] = explode('\n', y76F80Xef("taVar$x")); }  $ar = array(); for($x=1;$x<10;$x++) { $ar[] = y76F80Xef('txVar'.$x); } $x07A18bXA = implode(',', $ar);  $xAC063X21 = array(); for($x=1;$x<6;$x++) { $xAC063X21[] = y76F80Xef('txPath'.$x); } $strPathLab = implode(',', $xAC063X21); return ''; }   function xbGCd7X1X($testpath = false) { global $x0c547X4B;  for($x=5; $x>0; $x--) { $pd = y76F80Xef("taPath$x"); if( $testpath && ($pd != '') ) { $xF0F1beXf = strpbrk($pd, '\'&"'); if($xF0F1beXf) return "$xF0F1beXf[0]$x"; } $x0c547X4B['k'.$x] = explode('\n', $pd); } return ''; }   function getPostedPathsClean() { global $x0c547X4B;  $s = array('\'', '&', '"'); $r = array(  '', 'and', '');  for($x=5; $x>0; $x--) { $pd = y76F80Xef("taPath$x"); if($pd != '') $pd = str_replace($s, $r, $pd); $x0c547X4B['k'.$x] = explode('\n', $pd); } }  function x70Bd9X0G() { list($xa5X1abX3,$xx8E177Xc) = explode(' ',microtime()); return (float)$xx8E177Xc +(float)$xa5X1abX3; }  function x0X2d8Xe0($x0GB19aX1) { list($xa5X1abX3,$xx8E177Xc) = explode(' ',microtime()); $xBa6199X6 = (float)$xx8E177Xc +(float)$xa5X1abX3; return round($xBa6199X6 - $x0GB19aX1, 5); }   function y76F80Xef($fname) { global $theAuxDir;  if(!file_exists("$theAuxDir/snap/cp_$fname")) return ""; return file_get_contents("$theAuxDir/snap/cp_$fname"); }   function xcXE146X0($t) { $i = (int)$t; if($i == 0) return "$t seconds"; elseif($i == 1) return "$t second"; elseif($i < 60) return "$t seconds"; else { $xx85188XA = number_format($i).' seconds'; $m = (int)($i/60); $s = $i % 60; $xx85188XA .= ' ('.$m.'m '.$s.'s)'; return $xx85188XA; } }   function yEf2a7XC3() { global $theAuxDir, $x84e4eX9A, $x07A18bXA, $x72Ed0Xb1, $xBFb197Xx, $theSourceFilename, $buildLst, $vFolder;  $ar = array_merge($x84e4eX9A['fname'], $x84e4eX9A['i_fname']); $gk = array_keys($x84e4eX9A['group']); foreach($gk as $gar) { $ar = array_merge($ar, $x84e4eX9A['group'][$gar]['fname']); } $ar = array_unique($ar); foreach($ar as $fname) { $xBFb197Xx = file_get_contents($fname); $theSourceFilename = $fname;  xC2E8eXa9($x07A18bXA, $xBFb197Xx);     if(! empty($x72Ed0Xb1) ) break;  if($buildLst == 'V') { $dir = dirname("mpc_short_files/v/$vFolder/$fname"); if(! file_exists($dir)) mkdir($dir, 0777, true); file_put_contents("mpc_short_files/v/$vFolder/$fname", $xBFb197Xx); } else { $dir = dirname("$theAuxDir/tmp/$fname"); if(! file_exists($dir)) mkdir($dir, 0777, true); file_put_contents("$theAuxDir/tmp/$fname", $xBFb197Xx); } } }   function prepareWebroot() { global $x84e4eX9A, $dotdot;  $dpath = __DIR__.'/mpc_short_files/dynaparse.php'; foreach($x84e4eX9A['w_fname'] as $fn) { if(substr($fn, -1) == '/') continue; if(! file_exists("$dotdot$fn") ) continue;  $xx85188XA = file_get_contents("$dotdot$fn"); $xx85188XA = preg_replace('#include \'.*?/mpc_short_files/dynaparse.php#', "include '$dpath", $xx85188XA); file_put_contents("$dotdot$fn", $xx85188XA); } }   function xd11157X6($first_path) { global $x9fEfcX8f, $Project; global $theAuxDir, $xEG154XF3,$x3ED3cXF7; global $x1bc29Xb6,$x9Ba196Xc,$x84e4eX9A; global $xAxB37X4A,$xA91113X0,$x9Ba196Xc;  $xAC063X21 = array( 'status'=>'none','pstat'=>'ng','tstat'=>'ng','pmsg'=>'','tmsg'=>'', 'firstpath'=>'no paths','firsturl'=>'no urls','urlcount'=>'0', 'srclist'=>'0','ttlreadable'=>'0','diskspace'=>'no' ); if($x9fEfcX8f == 0) { echo json_encode($xAC063X21); return; } $xAC063X21['diskspace'] = diskSpace(); $xAC063X21['urlcount'] = $x9fEfcX8f; x2FF147X0($first_path, $xx5C14aXA, $x4c014fXC, $xAxB37X4A); $xAC063X21['pstat'] = 'ok'; $xAC063X21['firstpath'] = str_replace('//','/',trim($xx5C14aXA,'/'));  $dom = ($Project->smap_remote_yn == 'yes')? $Project->smap_remote_url : $x9Ba196Xc; $xAC063X21['firsturl'] = $dom.'/'.$xAC063X21['firstpath'];  $x1bc29Xb6 = $xA91113X0['jxSv']; if($x1bc29Xb6 != "") $xAC063X21['srclist'] = 1; $srcfile = ""; $x1CxacX8A = ""; x43x148XE(); if(! empty($x84e4eX9A['fname'])) { $srcfile = $x84e4eX9A['fname'][0]; $x1CxacX8A = $x84e4eX9A['dest'][0]; } else { $gk = array_keys($x84e4eX9A['group']); if(! empty($gk)) { if(! empty( $x84e4eX9A['group'][$gk[0]]['fname'] ) ) { $srcfile = $x84e4eX9A['group'][$gk[0]]['fname'][0]; $x1CxacX8A = $x84e4eX9A['group'][$gk[0]]['dest'][0]; } } }  if($srcfile == "") { $xAC063X21['tmsg'] = '--- no source files found ---'; echo json_encode($xAC063X21); return; }  $xAE0118X8 = strlen($x1CxacX8A); switch(substr($x1CxacX8A, -2)) { case '_#': case '_)': $sf = substr($x1CxacX8A,0,$xAE0118X8-2); break; case '_@': $sf = '/'.substr($x1CxacX8A,0,$xAE0118X8-2); break; case '_(': $sf = '/'.substr($x1CxacX8A,0,$xAE0118X8-2); break; default: $sf = '/'.$x1CxacX8A; break; } $xAC063X21['firsturl'] .= $sf;  $xAC063X21['srcfile'] = $srcfile;  $title = ""; $xx2D3XA2F = @fopen($srcfile,'r'); if(! $xx2D3XA2F) { $xAC063X21['tstat'] = 'ng'; $xAC063X21['tmsg'] = '--- cannot read source file ---'; echo json_encode($xAC063X21); return; }  while(!feof($xx2D3XA2F)) { $s = trim(fgets($xx2D3XA2F,128)); if($s == "") continue; $title = $s; break; } fclose($xx2D3XA2F);  $title = trim($title); if( ($title == "") || (substr($title, 0, 15) == '[mpc-shortcode:') ) { $xAC063X21['tmsg'] = '--- no title found ---'; echo json_encode($xAC063X21); return; } $xAC063X21['ttlreadable'] = 1;  $x4E914bXB = $xx5C14aXA.'/'.$x1CxacX8A; $x1dF14cXD = $x4c014fXC.'/'.$x1CxacX8A;  $v = $xA91113X0['var_first_lines']; if($v == ',,,,,,,,') { $xAC063X21['tstat'] = 'ok'; $xAC063X21['tmsg'] = $title; echo json_encode($xAC063X21); return; } $xCc067X3b = explode(',',$v); $xGc514dX7 = strtolower($xx5C14aXA);  $x3ED3cXF7 = array_fill(x0dE1fXCF,10,' ');  openZipDb(); for($x=1;$x<10;$x++) { $x02d9bXBX = trim(rawurldecode($xCc067X3b[$x-1])); $ar = explode('\n',$x02d9bXBX); $xEG154XF3['k'.$x][0] = $ar[0];  $x3ED3cXF7[x0dE1fXCF+$x] = xb42c6X0d($x, $xGc514dX7, $x4E914bXB, $x1dF14cXD, 0, 5); } closeZipDb(); if(strlen($title) > 6) { $ar = array(); for($x=1;$x<10;$x++) { $ar[] = ' '.y76F80Xef('txVar'.$x); } $vlab = implode(',', $ar);  xC2E8eXa9($vlab, $title); ycAc83X77($title); } $xAC063X21['tstat'] = 'ok'; $xAC063X21['tmsg'] = $title; echo json_encode($xAC063X21); }  function openZipDb() { global $theAuxDir; global $db_zipcode, $ar_zipcode;  $ar_zipcode = array(); $db_zipcode = new SQLite3("$theAuxDir/zip.db"); } function closeZipDb() { global $theAuxDir, $db_zipcode, $ar_zipcode;  $db_zipcode->close(); if(count($ar_zipcode) > 0) { file_put_contents( "$theAuxDir/xzipcode", serialize($ar_zipcode) ); } }   function yc9E81X9b($inString) { global $xAxB37X4A, $xEG154XF3, $x3ED3cXF7;  yE0F82XFb();  $ar = array(); for($x=1;$x<10;$x++) { $ar[] = ' '.strtolower(y76F80Xef('txVar'.$x)); } $strVarLabLo = implode(',', $ar);  y970a9X8b($p, PERM_ONE);  x2FF147X0($p, $xx5C14aXA, $x4c014fXC, $xAxB37X4A); $xGc514dX7 = strtolower($xx5C14aXA);  $x4E914bXB = $xx5C14aXA.'/'; $x1dF14cXD = $x4c014fXC.'/';  $xEG154XF3 = array(); for($x=1;$x<10;$x++) { $p = y76F80Xef('taVar'.$x).'\n'; if($p[0] == '{') { if(preg_match('/^\{(.+?)\|/', $p, $m) == 1) { $vv = trim($m[1]); } else { $vv = ""; } $xEG154XF3['k'.$x] = array($vv); continue; } if(preg_match('/^[\s ]*?(.+?)\\\n/', $p, $m) == 1) { $vv = trim($m[1]); } else { $vv = ""; } $xEG154XF3['k'.$x] = array($vv); }  $x3ED3cXF7 = array_fill(x0dE1fXCF,10,' '); openZipDb(); for($x=1;$x<10;$x++) { $x3ED3cXF7[x0dE1fXCF+$x] = xb42c6X0d($x, $xGc514dX7, $x4E914bXB, $x1dF14cXD, 0, 5); } closeZipDb();  $outString = $inString; ycAc83X77($outString); return $outString; }   function y7c4a8X5c(&$path, $PERM = PERM_ALL) { global $x9fEfcX8f, $theAuxDir, $x0c547X4B;  xbGCd7X1X(false); if(x46G10dX8()) { $xAC063X21 = array('status' => 'dupes'); return json_encode($xAC063X21); }  $t = (TESTING||DEBUG)? 1:0; if(file_exists("$theAuxDir/cancel")) unlink("$theAuxDir/cancel");  try { $x9fEfcX8f = y5x88fXbe($theAuxDir, $PERM, $t, "$theAuxDir/cancel"); }  catch(Exception $e) { $emsg = $e->getMessage(); trigger_error($emsg, E_USER_ERROR); if($emsg[0] == '{') { return $emsg; } else { return json_encode(array( 'status'=>'except', 'caption'=>'Blueprint error (exception)', 'msg'=>$emsg )); } }  if( file_exists("$theAuxDir/cancel") ) { $path = 'x'; return; }  $path = "";  if($PERM == PERM_ONE) { if(file_exists("$theAuxDir/permu1.php")) { $xx2D3XA2F = @fopen("$theAuxDir/permu1.php", 'r'); $path = trim(fgets($xx2D3XA2F)); fclose($xx2D3XA2F); } } else { if(file_exists("$theAuxDir/permu.php")) { $xx2D3XA2F = @fopen("$theAuxDir/permu.php", 'r'); $path = trim(fgets($xx2D3XA2F)); fclose($xx2D3XA2F); } } return ""; }   function getPermCount(&$path) { global $theAuxDir;  $t = (TESTING||DEBUG)? 1:0; if(file_exists("$theAuxDir/cancel")) unlink("$theAuxDir/cancel"); $n = y5x88fXbe($theAuxDir, PERM_ALL1, $t, "$theAuxDir/cancel");  $path = ( file_exists("$theAuxDir/cancel") )? 'x' : '';  return $n; }   function y970a9X8b(&$path, $perm_type ) { global $theAuxDir;  $t = (TESTING||DEBUG)? 1:0; $n = y5x88fXbe($theAuxDir, $perm_type, $t, ""); $path = ($n == 0)? "" : trim( file_get_contents("$theAuxDir/permu1.php") ); return $n; }   function yE0F82XFb() { global $xx213dXa3;  $xx213dXa3 = array('path1'=>1,'path2'=>2,'path3'=>3,'path4'=>4,'path5'=>5); for($x=1;$x<6;$x++) { $s = strtolower(y76F80Xef('txPath'.$x)); if($s != "") $xx213dXa3[$s] = $x; } }   function xC2E8eXa9($x68F95XEB, &$xx85188XA) { global $Project, $x9Ba196Xc, $xF3X195XC, $theWebRoot, $spin_stat, $xspin_stat, $proto, $projectF, $bodyTag, $x72Ed0Xb1;  $x68F95XEB = str_replace(' ','',$x68F95XEB); if($x68F95XEB != ',,,,,,,,') { $ar = explode(',', $x68F95XEB); array_unshift($ar,'url!'); for($x=0;$x<10;$x++) { $xBcX87XFC = trim($ar[$x]); if($xBcX87XFC != "") { $x0Ax56XAx[] = '/(#|#\+|#-|#\~)'.$xBcX87XFC.'(#|:s#|:l#|:u#|:t#|:h#|:w#)/i'; $x4335dXeA[] = '$1var'.$x.'${2}'; } } $xx85188XA = preg_replace($x0Ax56XAx,$x4335dXeA,$xx85188XA); }  $bodyTag = ''; if( preg_match('/<!--\[mpc-shortcode:\s+(redir|var_redir) .+?(\]-->)/', $xx85188XA, $m, PREG_OFFSET_CAPTURE) == 1) { $pos1 = $m[0][1]; $pos2 = $m[2][1]; $tchunk = substr($xx85188XA, 0, $pos1); $schunk = substr($m[0][0], 4, ($pos2 - $pos1) - 3); $xx85188XA = $schunk . $tchunk . substr($xx85188XA, $pos2+4); }  else if( preg_match('/<!--\[mpc-shortcode:\s+(overlay|var_overlay) .+?(\]-->)/', $xx85188XA, $m, PREG_OFFSET_CAPTURE) == 1) { if(preg_match('/<\/head>.*?(<body[^>]*>)(.)/is', $xx85188XA, $b, PREG_OFFSET_CAPTURE) != 1) { $x72Ed0Xb1 = json_encode(array( 'status'=>'prepare', 'msg'=>"no_body" )); return ""; }  $pos1 = $m[0][1];  $pos2 = $m[2][1];  $bbpos = $b[1][1]; $ebpos = $b[2][1];  $bodyTag = bin2hex($b[1][0]); $tchunk = substr($xx85188XA, 0, $pos1); $schunk = substr($m[0][0], 4, ($pos2 - $pos1) - 3);  $mchunk = substr($xx85188XA, $pos2+4, ($bbpos - $pos2) -4); $xx85188XA = $tchunk . $mchunk . $schunk . substr($xx85188XA, $ebpos); }  if( preg_match('/<!--\[mpc-shortcode: var_dyna .+?(\]-->)/', $xx85188XA, $m, PREG_OFFSET_CAPTURE) == 1) { $pos1 = $m[0][1]; $pos2 = $m[1][1]; $tchunk = substr($xx85188XA, 0, $pos1); $schunk = substr($m[0][0], 0, ($pos2 - $pos1) + 4); $xx85188XA = $schunk . $tchunk . substr($xx85188XA, $pos2 + 4); }  $xx85188XA = preg_replace_callback('/\[\s*mpc-shortcode:\s*youtube\s*(\{.+?\})\s*\]/i', '_youtubeCallback', $xx85188XA); $xx85188XA =    preg_replace_callback('/\[\s*mpc-shortcode:\s*yelp\s*(\{.+?\})\s*\]/i', '_yelpCallback', $xx85188XA); $xx85188XA =    preg_replace_callback('/\[\s*mpc-shortcode:\s*silo_table\s*(\d+,.+?,.*?)\s*\]/i', '_siloCallback', $xx85188XA); $xx85188XA =   preg_replace_callback('/\[\s*mpc-shortcode:\s+(redir|overlay|var_redir|var_overlay)\s+(\{.+?\})\s*\]/i', '_redirCallback', $xx85188XA); $xx85188XA =    preg_replace_callback('/<!--\[\s*mpc-shortcode:\s+(dyna|var_dyna|cinc)\s+(\{.+?\})\s*\]-->/i', '_dynaCallback', $xx85188XA);  $s = array( '/#rootsitemap!(?::h)?#/i', '/!domain-url!/',   '/!project-url!/',  '/!project-path!/', '/!webroot-path!/'  ); $pf = ($projectF == '')? '' : "/$projectF";  $r = array( $Project->smap_prefix.'-sitemap.html', $proto.'://'.$x9Ba196Xc, $proto.'://'.$x9Ba196Xc.$xF3X195XC.$pf, __DIR__.$pf, $theWebRoot ); $xx85188XA = preg_replace($s,$r,$xx85188XA);  $xx85188XA = preg_replace_callback('/\<(style|script)\b[^\>]*?>.*?\<\/\\1\>/is', '_set_xospinCback', $xx85188XA);  $spin_stat = SPIN_NONE; $xspin_stat = ''; $xx85188XA = preg_replace_callback('/(?:\<!-- ?)?(\[\/?[ndx]ospin\])(?: ?--\>)?/i', '_fixnospinCback', $xx85188XA); if($spin_stat != SPIN_NONE) $xx85188XA .= '[/nospin]';  $xx85188XA = preg_replace_callback('/#([+-~]?)var(\d)(#|:s#|:l#|:u#|:t#|:h#|:w#)/i', '_var2digits', $xx85188XA); }   function _set_xospinCback($m) { if( strpos($m[0], '{') === false) return $m[0]; else return "[xospin]$m[0][/xospin]"; }   function _fixnospinCback($m) { global $spin_stat, $xspin_stat; switch(strtolower($m[1])) { case '[xospin]': if($spin_stat == SPIN_NO) { $xspin_stat = ''; return '';        } else { $xspin_stat = '[/nospin]'; return '[nospin]'; } break;  case '[/xospin]': return $xspin_stat; break;  case '[nospin]': case '[/dospin]': if($spin_stat == SPIN_NO) return '';  $spin_stat = SPIN_NO; return '[nospin]'; break;  case '[/nospin]': case '[dospin]': if($spin_stat == SPIN_NONE) return '';  $spin_stat = SPIN_NONE; return '[/nospin]'; break; } }  $ifnum = 0;  function _youtubeCallback($m) { global $theAuxDir, $ifnum, $x72Ed0Xb1, $x2f0c0XG1, $theFnameFld, $xa532XF58; $ifnum++;  $ak = json_decode( file_get_contents("$theAuxDir/utsettings.php") ); if( empty($ak->api) ) { $x72Ed0Xb1 = json_encode(array( 'status'=>'prepare', 'msg'=>"ut_api" )); return ""; } $ak = str_rot13($ak->api);  $auto = 0;  $full = ""; $loop = 0;  $chan = "";  $hp   = 0;  $wp   = 0;  $bg   = "";  $j = json_decode($m[1], true); if($x2f0c0XG1 == 'text') { if( !empty($j['auto']) ) $auto = $j['auto']; if( !empty($j['full']) ) $full = 'allowfullscreen'; if( !empty($j['loop']) ) $auto = $j['loop']; if( !empty($j['chan']) ) $chan = $j['chan']; if( !empty($j['hp']) )   $hp = $j['hp']; if( !empty($j['wp']) )   $wp = $j['wp']; if( !empty($j['bg']) )   $bg = $j['bg']; if( !empty($j['h']) )    $h = $j['h']; if( !empty($j['w']) )    $w = $j['w']; if( !empty($j['keyw']) ) $keyw = $j['keyw'];  $xx85188XA = ""; $xx85188XA .= "[mpc_shortcode type=\"youtube\" h=\"$h\" w=\"$w\" bg=\"$bg\" keyw=\"$keyw\" ak=\"$ak\" ifnum=\"$ifnum\" ";  if($auto != 0)  $xx85188XA .= 'auto="1" '; if($full != "") $xx85188XA .= 'full="1" '; if($loop != 0)  $xx85188XA .= 'loop="1" '; if($chan != "") $xx85188XA .= 'chan="'.$chan.'" '; if($hp != 0)    $xx85188XA .= 'hp="1" '; if($wp != 0)    $xx85188XA .= 'wp="1" ';  $xx85188XA .= ']'; return $xx85188XA; } if( !empty($j['auto']) ) $auto = $j['auto']; if( !empty($j['full']) ) $full = 'allowfullscreen'; if( !empty($j['loop']) ) $auto = $j['loop']; if( !empty($j['chan']) ) $chan = $j['chan']; if( !empty($j['bg']) ) { if($j['bg'] == 0) $bg = "background-color:white;"; if($j['bg'] == 1) $bg = "background-color:black;"; } if( !empty($j['hp']) ) $hp = $j['hp']; if( !empty($j['wp']) ) $wp = $j['wp'];  $hp = ($hp == 1)? '%' : 'px'; $wp = ($wp == 1)? '%' : 'px'; $keyw = y0dD34XaX($j['keyw']);  $qdata = "auto={$auto}&loop={$loop}&keyw={$keyw}&chan={$chan}&ak={$ak}";  $xx85188XA = ""; $xx85188XA .= "<div style=\"height:{$j['h']}{$hp}; width:{$j['w']}{$wp}; {$bg} \">"; $xx85188XA .= "<iframe height=\"100%\" width=\"100%\" frameborder=\"0\" {$full}"; $xx85188XA .= ' src="<?php '; $xx85188XA .= '$fi = getcwd();'; $xx85188XA .= '$mpc_up = "";'; $xx85188XA .= 'while(!empty($fi))'; $xx85188XA .= "\vL"; $xx85188XA .= 'if(file_exists("$fi/'.$theFnameFld.'/mpc_short_files/youtube.php")) break;'; $xx85188XA .= '$mpc_up .= "../";'; $xx85188XA .= '$fi = dirname($fi);'; $xx85188XA .= "\vR"; $xx85188XA .= '$mpc_qdata = "'.$qdata.'";'; $xx85188XA .= 'include $mpc_up."'.$theFnameFld.'/mpc_short_files/youtube.php";'; $xx85188XA .= ' ?>'; $xx85188XA .= '"></iframe></div>';  return $xx85188XA; }   function _yelpCallback($m) { global $theAuxDir, $ifnum, $xF3X195XC, $x72Ed0Xb1, $x2f0c0XG1, $theFnameFld; $ifnum++;  $jj = json_decode( file_get_contents("$theAuxDir/yelpsettings.php") );  if( empty($jj->ck) || empty($jj->cs) || empty( $jj->tk) || empty($jj->ts) || empty($jj->limit) ) { $x72Ed0Xb1 = json_encode(array( 'status'=>'prepare', 'msg'=>"yelp_api" )); return ""; } $ck = str_rot13($jj->ck); $cs = str_rot13($jj->cs); $tk = str_rot13($jj->tk); $ts = str_rot13($jj->ts);  $jj = json_decode($m[1]); if( empty($jj->city) && empty($jj->state) && empty($jj->zip) ) { $x72Ed0Xb1 = json_encode(array( 'status'=>'prepare', 'msg'=>"Yelp shortcode is missing Location value.<br><b>$fname</b>" )); } $city  = ''; $state = ''; $zip   = ''; $term  = ''; $limit = '';  if($x2f0c0XG1 == 'text') { if(!empty($jj->city))  $city  = $jj->city; if(!empty($jj->state)) $state = $jj->state; if(!empty($jj->zip))   $zip   = $jj->zip; if(!empty($jj->term))  $term  = $jj->term; $limit = $jj->limit; $xx85188XA = ''; $xx85188XA .= "[mpc_shortcode_yelp type=\"yelp\" city=\"$city\" state=\"$state\" zip=\"$zip\" term=\"$term\" limit=\"$limit\" ck=\"$ck\" cs=\"$cs\" tk=\"$tk\" ts=\"$ts\"]"; return $xx85188XA; } if(!empty($jj->city))  $city  = $jj->city; if(!empty($jj->state)) $state = $jj->state; if(!empty($jj->zip))   $zip   = $jj->zip; if(!empty($jj->term))  $term  = $jj->term; $limit = $jj->limit;  $qdata = "city={$city}&state={$state}&zip={$zip}&term={$term}&limit={$limit}&ck={$ck}&cs={$cs}&tk={$tk}&ts={$ts}";  $xx85188XA = ""; $xx85188XA .= '<div>'; $xx85188XA .= '<?php '; $xx85188XA .= '$fi = getcwd();'; $xx85188XA .= '$mpc_up = "";'; $xx85188XA .= 'while(!empty($fi))'; $xx85188XA .= "\vL"; $xx85188XA .= 'if(file_exists("$fi/'.$theFnameFld.'/mpc_short_files/yelp.php")) break;'; $xx85188XA .= '$mpc_up .= "../";'; $xx85188XA .= '$fi = dirname($fi);'; $xx85188XA .= "\vR"; $xx85188XA .= '$mpc_qdata = "'.$qdata.'";'; $xx85188XA .= 'include $mpc_up."'.$theFnameFld.'/mpc_short_files/yelp.php";'; $xx85188XA .= ' ?>'; $xx85188XA .= '</div>';  return $xx85188XA; }   function _dynaCallback($m) { global $x07A18bXA, $theAuxPath, $theAuxDir, $x72Ed0Xb1;  $ar = json_decode($m[2], true); $name = $ar['location_ident']; $bVar = ($m[1] == 'var_dyna');  if($m[1] == 'cinc') $script = $theAuxPath.'/cinc.php'; else $script = dirname($theAuxPath).'/mpc_short_files/dynaparse.php';  $vstr = ""; $cstr = ""; foreach($ar as $k => $v) { if($k == 'location_ident') continue; $vstr .= '$'.$k.'=<<<'."$k\n$v\n$k;\n"; $cstr .= '/'.$k; }  $nstr = '$location_ident=\''.$name.$cstr.'\';'; $xx85188XA  = '<?php '; $xx85188XA .= $nstr;     $xx85188XA .= $vstr;     if($bVar) $xx85188XA .= 'ob_start();'; $xx85188XA .= "include '$script';"; if($bVar) $xx85188XA .= '$u__=ob_get_clean();'; $xx85188XA .= '?>'; return $xx85188XA;  }   function _siloCallback($m) { global $theAuxPath, $theAuxDir, $buildLst, $vFolder, $xa532XF58, $theSourceFilename;  $d = ($xa532XF58 == 'a0ca24XG9')? 'bh.db' : 'rh.db'; $xBxEc7XdA = "$theAuxPath/tmp/$theSourceFilename"; if($buildLst == 'V') { $xBxEc7XdA = dirname($theAuxPath).'/mpc_short_files/v/'.$vFolder.'/'.$theSourceFilename; }  $jm = "sitable,$buildLst,$m[1]"; $db = new SQLite3("$theAuxDir/$d"); $db->exec('BEGIN TRANSACTION;'); $id = $db->querySingle("SELECT id FROM source WHERE path='$xBxEc7XdA'"); $db->exec("UPDATE source SET jmisc='$jm' WHERE id='$id'"); $db->exec('COMMIT;'); $db->close();  return '#~var0#';     }   function _redirCallback($m) { global $theAuxPath, $proto, $x9Ba196Xc, $bodyTag;  $bDyna = (substr($m[1], 0, 4) == 'var_');  $domurl = $proto.'://'.$x9Ba196Xc; $s = array("'",'"'); $r = array('%27','%22'); $ar = json_decode($m[2], true);  $u = $ar['u']; $m = $ar['m']; $f = (empty($ar['f']))? 'r':$ar['f']; $b = ($f == 'r')? "" : $bodyTag; $c = $ar['c'];  $xx85188XA  = '<?php '; $xx85188XA .= "\$a__z=array();"; $xx85188XA .= ($bDyna)? "\$a__z['u']=\$u__;" : "\$a__z['u']='$u';";  $xx85188XA .= "\$a__z['m']='$m';";  $xx85188XA .= "\$a__z['f']='$f';";  $xx85188XA .= "\$a__z['b']='$b';"; $xx85188XA .= "\$a__z['c']='$c';";  for($x=1; $x <= $c; $x++) { $vnx = 'vn'.$x; $vvx = 'vv'.$x; $vn = $ar[$vnx]; $vv = $ar[$vvx]; $xx85188XA .= "\$a__z['$vnx']='$vn';";   if($vn == 'domain-url') { $xx85188XA .= "\$a__z['$vvx']='$domurl';";  continue; }  if($vn == 'ip-address') { $xx85188XA .= "\$a__z['$vvx']=\$_SERVER['REMOTE_ADDR'];";  continue; } $xx85188XA .= "\$a__z['$vvx']=urlencode('$vv');";  } $xx85188XA .= "include '$theAuxPath/redir.php'; ?>"; return $xx85188XA; }   function y0dD34XaX($xx85188XA) { $s = array('&',  '=',  '+'); $r = array('%26','%3d','%2b'); return str_replace($s, $r, $xx85188XA); }  function _var2digits($m) { if($m[1] == "") $m[1] = '=';   if($m[3] == '#') $m[3] = ':a#'; return '#'.'var'.$m[1].'0'.$m[2].$m[3]; }   function ycAc83X77(&$xx85188XA) { $xx85188XA = preg_replace_callback('/#var(\+|\-|\=|\~)0(\d)(:a#|:s#|:l#|:u#|:t#|:h#|:w#)/i', 'varCallback', $xx85188XA); }   function varCallback($m) { global $x3ED3cXF7, $Project;  $v = $x3ED3cXF7[x0dE1fXCF+$m[2]];  switch($m[3]) { case ':a#': return $v; break; case ':s#': return ucfirst(strtolower($v)); break; case ':l#': return strtolower($v); break; case ':u#': return strtoupper($v); break; case ':t#': return ucwords(strtolower($v)); break; case ':h#': if($Project->lowurl_yn == 'yes') $v = strtolower($v); return str_replace(' ','-',$v); break; case ':w#': return str_replace(' ','+',$v); break; default: return $m[0]; break; } }   function yC3a85XB5() { global $theAuxDir; $ar = explode('\n', file_get_contents("$theAuxDir/snap/cp_taSource")); return scanFirstDest($ar, $bctype); }   function scanFirstDest($ar, &$bctype) { foreach($ar as $s) { if(preg_match('/^\[\s*asset\s*\]/i', $s) == 1) continue;  if(preg_match('/^\[\s*webroot\s*\]/i', $s) == 1) continue;  if(substr($s, 0, 9) == '[default]') $s = substr($s, 9);  $bctype = 'exten';  if(preg_match('/^\s*(.*)\s*>>\s*(\[.*\])\s*(.*)$/', $s, $m) == 1) return trim($m[3]);  if(preg_match('/^\s*(.*)\s*>>\s*(.*)$/', $s, $m) == 1) return trim($m[2]);  $bctype = 'file';  if(preg_match('/^\s*(.*)\s*>\s*(\[.*\])\s*(.*)$/', $s, $m) == 1) return '/'.trim($m[3]);  if(preg_match('/^(.*)>(.*)$/', $s, $m) == 1) return '/'.trim($m[2]);  if(preg_match('/^(\[\s*index\s*=\s*\w+\])(.*)$/i', $s, $m) == 1) continue;  if(preg_match('/^(\[\s*file\s*=\s*\w+\])(.*)$/i', $s, $m) == 1) continue;  return '/'.trim($s); } return ""; }   function sortSourceBoxCP($xx85188XA, &$firstSrc) { global $theAuxDir;  $x0XC64XFb  = array(); $ar_d = array(); $ar_g = array(); $ar_i = array(); $ar_a = array(); $ar_w = array(); $ar = explode('\\n', $xx85188XA); sort($ar); foreach($ar as $e) { if($e[0] != '[') { $x0XC64XFb[] = $e; continue; } switch($e[1]) { case 'd': $ar_d[] = $e; break; case 'g': $ar_g[] = $e; break; case 'i': $ar_i[] = $e; break; case 'a': $ar_a[] = $e; break; case 'w': $ar_w[] = $e; break; } } $ar_w = array_unique($ar_w); $x0XC64XFb = array_merge($x0XC64XFb, $ar_d, $ar_g, $ar_i, $ar_a, $ar_w); file_put_contents( "$theAuxDir/snap/cp_taSource", implode('\\n', $x0XC64XFb) ); $firstSrc = $x0XC64XFb[0]; return implode("\n", $x0XC64XFb); }   function getTimestamp($offset) { $x2CGaeX00 = new DateTime( 'now', new DateTimeZone('GMT') ); if( strtolower($offset) != 'gmt') { $t = (int)substr($offset, 1, 1); if( substr($offset, 0, 1) == '+') { $x2CGaeX00->add( new DateInterval('PT'.$t.'H') ); } else { $x2CGaeX00->sub( new DateInterval('PT'.$t.'H') ); } } return $x2CGaeX00->format('\-Ymd-H\hi'); }       $xD0B23XF3 = ""; $x2f0c0XG1 = "html"; if(isset($_POST['Q64'])) { $que = json_decode( base64_decode( str_replace( array('-','_','.'),array('+','/','='), $_POST['Q64'] ) ), true); $xD0B23XF3 = (! empty($que['QS']))? $que['QS'] : ""; $xAxB7X09e = (! empty($que['FormButton']))? $que['FormButton'] : ""; }   session_start(); if(!isset($_SESSION['yAGGbX2fe'])) $_SESSION['yAGGbX2fe'] = $_SERVER['REMOTE_ADDR'];  $_SESSION['ssl'] = 'http'; if( (!empty($_SERVER['HTTPS'])) && ($_SERVER['HTTPS'] == 'on') ) $_SESSION['ssl'] = 'https';  if((!isset($_SESSION['yE7b20XAc'])) || ($y1bc29Xb6 == 1)) $_SESSION['yE7b20XAc'] = $y1bc29Xb6; $y1bc29Xb6 = $_SESSION['yE7b20XAc'];   if($xD0B23XF3 == 'doUpdate') { if(is_file("$theAuxDir/version.php")) unlink("$theAuxDir/version.php"); require_once($theAuxDir.'/update.php'); }  if(!isset($_SESSION['yABbaXE2G'])) $_SESSION['yABbaXE2G'] = "";   if(@$_SESSION['yxec9XxDG'] != 'yes') { if(!TESTING) x59e179XE();  if( (isset($_GET['logout'])) && ($_GET['logout'] == 2) ) { $_SESSION['yABbaXE2G'] = json_encode(array('cmd'=>'dD','fname'=>$theFname)); } else { if( is_file("$theAuxDir/spin.php") && is_file("$theAuxDir/spin5.php") )  { $L = "No License"; $U = "No Email"; if(file_exists($theSname)) require($theSname);  require_once "$theAuxDir/spin.php"; $ar = array( 'cmd' => 'update5', 'email' => $U, 'key' => $L, 'ver' => $VER );  if(xa457dXx0($ar, $out)) { if(! TESTING) { $rj = json_decode($out); if($rj->ustat == 'critical') { $_SESSION['yABbaXE2G'] = json_encode(array('cmd'=>'dU','fname'=>$theFname,'oldver'=>$VER,'newver'=>$rj->newver)); } } } } } }   if($_SESSION['yABbaXE2G'] == "") { if(file_exists('credentials.zip')) { xGB8bfX7x(); unlink('credentials.zip'); } if(!file_exists($theSname)) { $_SESSION['yABbaXE2G'] = json_encode(array('cmd'=>'dC')); } }  if(file_exists($theSname)) require($theSname);  if($_SESSION['yABbaXE2G'] == "") { if(@$_SESSION['yxec9XxDG'] != 'yes') { $_SESSION['yABbaXE2G'] = json_encode(array('cmd'=>'dL')); }  }   if(! file_exists($theAuxDir)) {   mkdir($theAuxDir, 0777); xEA9a0XxF(); if( !file_exists('mpc_short_files') ) mkdir('mpc_short_files', 0777); copy("$theAuxDir/mpc_short_files/dynaparse.php", './mpc_short_files/dynaparse.php'); copy("$theAuxDir/mpc_short_files/youtube.php", './mpc_short_files/youtube.php'); copy("$theAuxDir/mpc_short_files/yelp.php", './mpc_short_files/yelp.php'); copy("$theAuxDir/mpc_short_files/OAuth.php", './mpc_short_files/OAuth.php'); if(! TESTING) { $xF0F1beXf = xdfG133Xa('http://masspagecreator.com/ck/bin/rip/ip.db'); file_put_contents("$theAuxDir/ip.db", $xF0F1beXf); cleanupOnce(); } } else { $xb0C136XA = false; if(file_exists("$theAuxDir/version.php")) { $oldver = file_get_contents("$theAuxDir/version.php"); if((int)$VER > (int)$oldver) $xb0C136XA = true; } else { $xb0C136XA = true;  $AUX = opendir($theAuxDir); while($f = readdir( $AUX)) { if(preg_match('/\d\d\d\.php$/',$f) == 1) unlink("$theAuxDir/$f"); } closedir($AUX); }  if($xb0C136XA) {   if(file_exists("$theAuxDir/mpcerr_log")) unlink("$theAuxDir/mpcerr_log");  if(is_dir("$theAuxDir/css")) y20ad4XXc('css'); if(is_dir("$theAuxDir/js")) y20ad4XXc('js');  xEA9a0XxF(); if( !file_exists('mpc_short_files') ) mkdir('mpc_short_files', 0777); copy("$theAuxDir/mpc_short_files/dynaparse.php", './mpc_short_files/dynaparse.php'); copy("$theAuxDir/mpc_short_files/youtube.php", './mpc_short_files/youtube.php'); copy("$theAuxDir/mpc_short_files/yelp.php", './mpc_short_files/yelp.php'); copy("$theAuxDir/mpc_short_files/OAuth.php", './mpc_short_files/OAuth.php'); if(! TESTING) { $xF0F1beXf = xdfG133Xa('http://masspagecreator.com/ck/bin/rip/ip.db'); file_put_contents("$theAuxDir/ip.db", $xF0F1beXf); cleanupOnce(); } } }  if(! TESTING ) { if(! function_exists("proc_open")) { y0d02cXC6('no_proc_open'); exit(); } if(! function_exists("proc_close")) { y0d02cXC6('no_proc_close'); exit(); }  require_once "$theAuxDir/spin.php"; try { $xF0F1beXf = x5bXdXc8b(" sbt5 -p 1 -x $theAuxDir"); $xAE0118X8 = strlen("$theAuxDir"); if($xF0F1beXf != $theAuxDir.'_'.$xAE0118X8) { y0d02cXC6('sbt5'); exit(); } } catch(Exception $e) { $e->getMessage(); file_put_contents("./error_log", "\ndowngrade: sbt5x: ".$e->getMessage()."\n", FILE_APPEND); y0d02cXC6('sb2'); exit(); } }   function cullif() { global $theAuxDir;  if(x3X8daXD2() == 'Windows') return;  $x74265XB7 = json_decode( file_get_contents("$theAuxDir/settings"), true ); $old = $x74265XB7['cullticks']; $now = time(); $age = $now - (int)$old;  if($age > 2*24*60*60) { $x74265XB7['cullticks'] = $now; file_put_contents( "$theAuxDir/settings", json_encode($x74265XB7) );  cullBackups($x74265XB7['culldays']); } }   function cullBackups($days) { global $theMpcPath, $theAuxDir;  $oldFolder = '.Backup_Files'; $newFolder = '.Backup-Files'; $bfdir = ''; if(file_exists("$theMpcPath/$oldFolder")) $bfdir = "$theMpcPath/$oldFolder"; else if(file_exists("$theMpcPath/$newFolder")) $bfdir = "$theMpcPath/$newFolder"; if($bfdir == '') return;  $dayslose = '+'.$days ; $xF0F1beXf = trim(doProcCommand("find $bfdir -type f -mtime $dayslose")); if($xF0F1beXf != '') doProcCommand("find $bfdir -type f -mtime $dayslose -exec rm '{}' \;");  while(trim(doProcCommand("find $bfdir -mindepth 1 -type d -empty")) != '') { doProcCommand("find $bfdir -mindepth 1 -type d -empty -exec rmdir '{}' \;"); }  if($bfdir == "$theMpcPath/$oldFolder") { $str_keep = trim(doProcCommand("find $bfdir -type f")); if($str_keep != '') { $str_keep .="\n"; $xF0F1beXf = preg_replace_callback("/\.Backup_Files\/([^\n]*)_(1\d)\.(\d\d)\.(\d\d)_(\d\d)\.(\d\d)\.(\d\d)\n/", function($m) { global $theMpcPath; rename("$theMpcPath/".trim($m[0]), "$theMpcPath/.Backup_Files/$m[1]-20$m[2]$m[3]$m[4]-$m[5]h$m[6]m$m[7]"); return $m[0]; }, $str_keep ); } rename("$theMpcPath/$oldFolder", "$theMpcPath/$newFolder"); } }       function doProcCommand($cmd) { $desc = array( 0 => array("pipe", "r"), 1 => array("pipe", "w"), 2 => array("pipe", "w")  ); $pipes = array();  $process = proc_open("find $cmd", $desc, $pipes);  if(is_resource($process)) { $rval = stream_get_contents($pipes[1]); proc_close($process); $success = true; } return $rval; }       if(is_dir("$theAuxDir/tmp")) x60C9cX1b("$theAuxDir/tmp"); if(is_dir("$theAuxDir/uploads")) x60C9cX1b("$theAuxDir/uploads"); mkdir("$theAuxDir/uploads", 0777);  if(file_exists("$theAuxDir/kr.php")) unlink("$theAuxDir/kr.php"); if(file_exists("$theAuxDir/ko.php")) unlink("$theAuxDir/ko.php"); if(file_exists("$theAuxDir/ki.php")) unlink("$theAuxDir/ki.php"); if(file_exists("$theAuxDir/kx.php")) unlink("$theAuxDir/kx.php"); if(file_exists("$theAuxDir/ks.php")) unlink("$theAuxDir/ks.php");  $xx85188XA = "<?php \n"; $xx85188XA .= "\$glb_theAuxDir = '$theAuxDir';\n"; $xx85188XA .= "\$glb_theMpcPath = '$theMpcPath';\n"; file_put_contents("$theAuxDir/glb.php", $xx85188XA);  $cwd = getcwd(); chdir($theAuxDir); if( is_file('src.zip') ) { x60C9cX1b('snap'); $zip = new PclZip('src.zip'); $zip->extract(PCLZIP_OPT_PATH, '../', PCLZIP_OPT_REPLACE_NEWER); unlink('src.zip'); }  if( is_file('snap.zip') ) { $zip = new PclZip('snap.zip'); $zip->extract(PCLZIP_OPT_REPLACE_NEWER); unlink('snap.zip'); } chdir($cwd);  if(! is_dir("$theAuxDir/snap")) mkdir("$theAuxDir/snap", 0777);  if(! is_dir("$theAuxDir/vt")) mkdir("$theAuxDir/vt", 0777);   if(is_file("$theAuxDir/DEBUG")) unlink("$theAuxDir/DEBUG");   if(file_exists("$theAuxDir/utsettings.php")) { $xF0F1beXf = file_get_contents("$theAuxDir/utsettings.php"); if($xF0F1beXf[0] != '{') { unlink("$theAuxDir/utsettings.php"); if(file_exists("$theAuxDir/artsettings.php")) unlink("$theAuxDir/artsettings.php"); if(file_exists("$theAuxDir/spinsettings.php")) unlink("$theAuxDir/spinsettings.php"); } }  file_put_contents("$theAuxDir/vf.php", '<script src="'.$xF3X195XC.'/jquery.1.11.2.min.js"></script><iframe src="<?php echo $u__; ?>" height="" width="" id="i__f"></iframe></body></html><?php exit();' );  file_put_contents($theAuxDir.'/test_htaccess/test_ea/.htaccess', 'AddType application/x-httpd-ea-php'.$pver.' .php .php5 .phtml .html .htm');  $xd30fbX9b = xbG9106X5(); xb5f105Xx();   yfdd2aX04(); yfdGd6XXE(); initGmSettingsFile(); initGpSettingsFile(); initYelpSettingsFile(); initYelpSettingsFile3(); initSiSettingsFile(); ybGCd7X1X(); y0X2d8Xe0(); initS3SettingsFile();  initPxSettingsFile();   if( file_exists("$theAuxDir/!mpcfolder!")) unlink("$theAuxDir/!mpcfolder!"); if( file_exists("$theAuxDir/edit/!mpcfolder!")) unlink("$theAuxDir/edit/!mpcfolder!");     $yBaA11X6G = @$_SESSION['ya532XF58']; $bxd = ($yBaA11X6G == 1); $x5G6119XB =  @$_SESSION['yx4e8X66F']; $ht_vaname = ''; $vnum = @$_SESSION['vnum']; $vname = @$_SESSION['vaname']; if(@$_SESSION['dual'] == 2) $ht_vaname = '<span style="color:pink">VA-'.$vnum.'</span>&nbsp;&nbsp;'; else if(! empty($_SESSION['vaname'])) $ht_vaname = '<span style="color:lightgreen">'.$vname.'</span>&nbsp;&nbsp;'; $ht_redir = ''; $ht_rss = ''; $ht_va = ''; $ht_dynamic = ''; $ht_ck = 'x';  if(@$_SESSION['yxec9XxDG'] == 'yes') { cullif();  $xa7Af7X42 = 1; $x0C7120Xc = ''; $es_button = ''; list($a,$b,$v) = explode(':',$x5G6119XB); $x3Exf8X02 = ''; $ht_a51 = ''; if($v == 'Commercial') { $ht_ck = 'c'.$_SESSION['dbid'];       $ht_rss     = '<a href="#" onClick="MpcCpanel.diaRss();return false" title="Set RSS feed parameters">RSS</a>&nbsp;|&nbsp;'; $ht_dynamic = '<a href="#" onClick="MpcCpanel.diaDynamic();return false" title="Edit data for Dynamic and Cloaked Includes">Includes</a>&nbsp;|&nbsp;'; $x3Exf8X02  = '<a href="#" onClick="MpcCpanel.diaRemote();return false" title="Send Mpc, Projects, or Tar files to Remote Servers">Remote</a>&nbsp;|&nbsp;'; $ht_a51     = '<a href="https://masspagecreator.com/links.php?go=redir" target="_blank" title="Enter if you dare">Area51</a> |';  if($_SESSION['dual'] == 2) $ht_va = 'VA&nbsp;|&nbsp;'; else if( (empty($_SESSION['vaname'])) && ($_SESSION['dual'] == 0) ) $ht_va = '<a href="#" onClick="MpcCpanel.diaVa();return false" title="Control your VA licenses">VA</a>&nbsp;|&nbsp;'; } } else { $xa7Af7X42 = 0; $x0C7120Xc = 'visibility:hidden'; $es_button = 'visibility:hidden'; $x3Exf8X02 = ''; }  $xe1G1a6X9 = '<span title="operating system | php version | upload_max_filesize">'.x3X8daXD2().' | '.$x20F154X0.' | '.ini_get('upload_max_filesize').'</span>';  $wlic = 1; $x7041b6X1 = 'display:none'; $xbB31b7X7   = 'display:none'; if($x5G6119XB != "") { if( (strpos($x5G6119XB, ':Pro') !== false) || (strpos($x5G6119XB, ':Com') !== false) || (strpos($x5G6119XB, ':Demo') !== false) ) $wlic = 0; } $_SESSION['wlic'] = $wlic; $ht_wp = $y1bc29Xb6|$wlic; if($ht_wp == 0) { $x7041b6X1 = ""; $xbB31b7X7   = ""; $ht_xml = '<a href="#" onClick="MpcCpanel.diaXml();return false" title="Build Google-ready XML Sitemaps">XML-Sitemap</a>&nbsp;|&nbsp;'; } else { $ht_xml = ""; $ht_dynamic = ''; }  $theme = array(); $theme['cpBoxMarT'] = '20px'; $theme['cpBoxBdrW'] = '2px'; switch($xd30fbX9b) { case 'blue': $theme['cpBoxBgnd'] = '#c2ceea'; $theme['cpBoxBdrC'] = '#fff'; $theme['bgnd'] = '#c2ceea'; $theme['text'] = 'black'; $theme['footc'] = 'black'; $theme['foota'] = 'blue'; $theme['btnEmpty'] = '#666666'; $theme['btnFull'] = '#2675b5'; $theme['btnUnSel'] = 'white'; $theme['inpColor'] = 'black'; $theme['inpBgnd'] = 'white'; $theme['inpBord'] = '#aabbcc'; break;  case 'green': $theme['cpBoxBgnd'] = '#afd76b'; $theme['cpBoxBdrC'] = '#fff'; $theme['bgnd'] = '#afd76b'; $theme['text'] = '#000'; $theme['footc'] = '#000'; $theme['foota'] = 'blue'; $theme['btnEmpty'] = '#666666'; $theme['btnFull'] = '#257a25'; $theme['btnUnSel'] = 'white'; $theme['inpColor'] = 'black'; $theme['inpBgnd'] = 'white'; $theme['inpBord'] = '#8DC334'; break;  case 'rose': $theme['cpBoxBgnd'] = '#f5c0d0'; $theme['cpBoxBdrC'] = '#fff'; $theme['bgnd'] = '#F5C0D0'; $theme['text'] = 'black'; $theme['footc'] = 'black'; $theme['foota'] = 'blue'; $theme['btnEmpty'] = '#666'; $theme['btnFull'] = '#5e0c0c'; $theme['btnUnSel'] = 'white'; $theme['inpColor'] = 'black'; $theme['inpBgnd'] = 'white'; $theme['inpBord'] = '#EC7EA0'; break;  case 'magenta': $theme['cpBoxBgnd'] = '#cab6eb'; $theme['cpBoxBdrC'] = '#fff'; $theme['bgnd'] = '#cab6eb'; $theme['text'] = '#000'; $theme['footc'] = '#000'; $theme['foota'] = 'blue'; $theme['btnEmpty'] = '#666666'; $theme['btnFull'] = '#46257A'; $theme['btnUnSel'] = 'white'; $theme['inpColor'] = 'black'; $theme['inpBgnd'] = 'white'; $theme['inpBord'] = '#B7A9CC'; break;  case 'gold': $theme['cpBoxBgnd'] = '#f6dc76'; $theme['cpBoxBdrC'] = '#fff'; $theme['bgnd'] = '#f6dc76'; $theme['text'] = 'black'; $theme['footc'] = '#000'; $theme['foota'] = 'blue'; $theme['btnEmpty'] = '#666'; $theme['btnFull'] = '#635106'; $theme['btnUnSel'] = 'white'; $theme['inpColor'] = 'black'; $theme['inpBgnd'] = 'white'; $theme['inpBord'] = '#F0CA2E'; break;  case 'ibm': $theme['cpBoxBgnd'] = 'black'; $theme['cpBoxBdrC'] = '#00ff00'; $theme['bgnd'] = 'black'; $theme['text'] = '#00ff00'; $theme['footc'] = '#00ff00'; $theme['foota'] = '#00ff00'; $theme['btnEmpty'] = '#004000'; $theme['btnFull'] = '#008000'; $theme['btnUnSel'] = 'white'; $theme['inpColor'] = '#00ff00'; $theme['inpBgnd'] = 'black'; $theme['inpBord'] = 'green'; break;  case 'legacy': $theme['cpBoxBgnd'] = "url($theAuxDir/images/bg.gif) #c4c4c4"; $theme['cpBoxBdrC'] = '#333'; $theme['bgnd'] = '#666666'; $theme['text'] = 'black'; $theme['footc'] = '#f0f0f0'; $theme['foota'] = '#ffd700'; $theme['btnEmpty'] = '#666666'; $theme['btnFull'] = '#255190'; $theme['btnUnSel'] = 'white'; $theme['inpColor'] = 'black'; $theme['inpBgnd'] = 'white'; $theme['inpBord'] = '#808080'; $theme['cpBoxMarT'] = '21px'; $theme['cpBoxBdrW'] = '1px 2px 2px 1px'; break;  default: $theme['cpBoxMarT'] = '21px'; $theme['cpBoxBdrW'] = '1px 2px 2px 1px'; $theme['cpBoxBgnd'] = '#c4c4c4'; $theme['cpBoxBdrC'] = '#333'; $theme['bgnd'] = '#666666'; $theme['text'] = 'black'; $theme['footc'] = '#f0f0f0'; $theme['foota'] = '#ffd700'; $theme['btnEmpty'] = '#666666'; $theme['btnFull'] = '#255190'; $theme['btnUnSel'] = 'white'; $theme['inpColor'] = 'black'; $theme['inpBgnd'] = 'white'; $theme['inpBord'] = '#808080'; break; } $xbcCf6XD0 = "background:{$theme['cpBoxBgnd']};margin-top:{$theme['cpBoxMarT']};border-width:{$theme['cpBoxBdrW']};border-color:{$theme['cpBoxBdrC']}"; $xddBecX6e = "background:{$theme['bgnd']};color:{$theme['text']}"; $xd64f2XeA = "color:{$theme['footc']}"; $xAfbf1X4B = "color:{$theme['foota']}"; $xG26eeX58 = "background-color:{$theme['btnEmpty']};color:{$theme['btnUnSel']}"; $x4dEefXfx = "background-color:{$theme['btnFull']}"; $xeFcf3XD9 = "color:{$theme['inpColor']};background-color:{$theme['inpBgnd']};border-color:{$theme['inpBord']}";  if(TESTING) { $ht_cssloc = 'cssfiles'; $xEEEf0XeX =   'cssfiles/cpanel.css'; $x65bf9XX0 =   'cssfiles/button.css'; $ht_sbcss = 'cssfiles/shadowbox.css'; $ht_cmcss = 'cssfiles/contextMenu.css'; $ht_cmjs =  'jsfiles/contextMenu.js'; $ht_sb =    'jsfiles/shadowbox.js'; $ht_tv =    'jsfiles/treeview.js'; `jsfiles/join_all.sh`; $xGGcf5Xb0 =    'BUILD/cat.js'; } else { $ht_cssloc = "$theAuxDir/css"; $xEEEf0XeX =   "$theAuxDir/css/mpc.cpanel.$VER.min.css"; $x65bf9XX0 =   "$theAuxDir/css/mpc.button.$VER.min.css"; $ht_sbcss = "$theAuxDir/css/mpc.sbox.$VER.min.css"; $ht_cmcss = "$theAuxDir/css/mpc.cmenu.$VER.min.css"; $ht_cmjs =  "$theAuxDir/js/mpc.cmenu.$VER.min.js"; $xGGcf5Xb0 =    "$theAuxDir/js/mpc.cpanel.$VER.min.js"; $ht_sb =    "$theAuxDir/js/mpc.sbox.$VER.min.js"; $ht_tv =    "$theAuxDir/js/mpc.tview.$VER.min.js"; }     function cleanupOnce() { if(file_exists('mpc_short_files/dyna_name.php')) { $x976a1XCX = file_get_contents('mpc_short_files/dyna_name.php'); if( trim($x976a1XCX) == 'Untitled' ) file_put_contents('mpc_short_files/dyna_name.php', ''); } }   function xa457dXx0($ar, &$out = "") { global $theDomainP, $theAuxDir;  $ar['ip'] = $_SESSION['yAGGbX2fe']; $ion = (extension_loaded('ioncube loader'))? ioncube_loader_version() : 'none';  $t = (TESTING||DEBUG)? 1:0; $xaFD162Xd  =  'c='.urlencode($ar['cmd']); $xaFD162Xd .= '&ion='.$ion; $xaFD162Xd .= '&e='.urlencode($ar['email']); $k4 = substr($ar['key'], -4); $xaFD162Xd .= '&k='.urlencode($k4); $xaFD162Xd .= '&v='.urlencode($ar['ver']); $xaFD162Xd .= '&i='.urlencode($ar['ip']); $xaFD162Xd .= '&d='.urlencode($theDomainP);   $xF0F1beXf = json_decode(yGGX30XeD(urlencode(json_encode($ar)), $t, $theAuxDir, $xaFD162Xd), false); if($xF0F1beXf->istatus == "60") y38C2eXB4(); if($xF0F1beXf->istatus != "0") { trigger_error($xF0F1beXf->response,E_USER_ERROR); $out = 'Network error '.$xF0F1beXf->istatus.'. Please retry.'; return false; } $out = $xF0F1beXf->response; return true; }   function y38C2eXB4() { header("location: http://masspagecreator.com/ck/errpage.php?cmd=cert"); exit(); }   function y0d02cXC6($reason) { global $theAuxDir, $thePath, $theFname, $theFnameUrl;  if($reason != 'sb2') { file_put_contents("./error_log", "\ndowngrade: $reason\n", FILE_APPEND); }  if(is_file("$theAuxDir/version.php")) unlink("$theAuxDir/version.php"); if(is_file("$theAuxDir/spin5.php")) unlink("$theAuxDir/spin5.php");     $uniquename = xCGedbXCx('mpc.bin'); $x7dd70X7e = xdfG133Xa('https://masspagecreator.com/ck/auto/mpc3.bin'); if(!$x7dd70X7e) { header('location:https://masspagecreator.com/ck/updated.php?s=ng&u='.urlencode($thePath).'&f='.urlencode($theFname)); exit(); } $x6614XE05 = fopen($uniquename, 'w'); if(! $x6614XE05) { header('location:https://masspagecreator.com/ck/updated.php?s=ng&u='.urlencode($thePath).'&f='.urlencode($theFname)); exit(); } fwrite($x6614XE05, $x7dd70X7e); fclose($x6614XE05);  unlink($theFname); rename($uniquename, $theFname);  header("location:$theFnameUrl"); exit(); }  $arIgnore;  function x0GFd5Xf0( $path = '.' ) { global $theSname, $theFname, $theZname, $theAuxDir, $arIgnore, $xAxB7X09e;  $arIgnore = array( '.', '..','.htaccess','!mpcfolder!','php.ini','php5.ini','pclzip.lib.php','mpc-asset.php', 'jquery.1.11.2.min.js', 'mpc_short_files','json.lib.php',$theSname,$theFname,$theZname,$theAuxDir,'error_log','error.log','DEBUG', '.Backup_Files' );  if(TESTING)  { $ar = array('BPAGE_aux','BUILD','cssfiles','.git','.gitignore','jsfiles','old'); $arIgnore = array_merge($arIgnore, $ar); }  if($xAxB7X09e == 'addAsset') $arIgnore[] = '.Backup-Files'; _getDirectory($path); } function _getDirectory($path = '.') { global $arIgnore,$xAxB7X09e; $dir = opendir($path); $x3GGc3X7c = array(); while ( $filename = readdir( $dir ) ) { if(!in_array($filename, $arIgnore)) { if( is_dir("$path/$filename")) $filename .= '/'; $x3GGc3X7c[] = $filename; } } closedir ($dir); sort($x3GGc3X7c); echo "<ul>";  foreach ( $x3GGc3X7c as $filename ) { if(substr($filename,-1) == '/') { if(($xAxB7X09e == 'delPage') || ($xAxB7X09e == 'addAsset') || $xAxB7X09e == 'copyP2W' || $xAxB7X09e == 'copyP2P') { if($path == '.') $p = ''; else $p = (substr($path,0,2) == './')? substr($path,2) : $path; if($p != "") $p .= '/'; echo "<li><span class='folder' onclick=\"MpcCpanel.treeClick('$p$filename','$xAxB7X09e')\">".substr($filename,0,-1)."</span>"; } else { echo "<li><span class='folder'>".substr($filename,0,-1)."</span>"; } } else { if($path == '.') $p = ''; else $p = (substr($path,0,2) == './')? substr($path,2) : $path; if($p != "") $p .= '/'; $f = trim($filename,'/'); echo "<li><span class='file' onclick=\"MpcCpanel.treeClick('$p$f','$xAxB7X09e')\">$f</span>"; } if(substr($filename,-1 ) == '/') _getDirectory("$path/" . substr($filename,0,-1)); { echo "</li>"; } } echo "</ul>"; }   function y09a32X5D($rootDir, $allData=array()) { $x896100X5 = array('.', '..'); $dirContent = scandir($rootDir); foreach($dirContent as $key => $content) { $path = $rootDir.'/'.$content; if(!in_array($content, $x896100X5)) { if(is_file($path) && is_readable($path)) { $allData[] = $path; }elseif(is_dir($path) && is_readable($path)) { $allData = y09a32X5D($path, $allData); } } } return $allData; }   function x46G10dX8() { global $x0c547X4B;  for($x=1; $x<6; $x++) { if(empty($x0c547X4B['k'.$x])) continue; if( count($x0c547X4B['k'.$x]) != count(array_unique($x0c547X4B['k'.$x])) ) return true; } return false; }   function x5x88fXbe(&$xAC063X21) { global $x0c547X4B;  $dtf = 0; for($x=1; $x<6; $x++) { $d = 0; $c = 0; $xAC063X21['pd'.$x] = ''; $xAC063X21['pc'.$x] = ''; if(!empty($x0c547X4B['k'.$x][0])) { $c = count($x0c547X4B['k'.$x]); $xAC063X21['pc'.$x] = number_format($c); $d = $c - count(array_unique($x0c547X4B['k'.$x])); if($d > 0) { $xAC063X21['pd'.$x] = number_format($d); $dtf = 1; } }  $s = y76F80Xef("txPath$x"); $xAC063X21['txp'.$x] = ($s == '')? 'Path'.$x : $s; } $xAC063X21['dtf'] = $dtf;  for($x=1; $x<10; $x++) { $s = y76F80Xef("txVar$x"); $xAC063X21['txv'.$x] = ($s == '')? 'Var'.$x : $s; $v = y76F80Xef("taVar$x"); $c = ($v == '')? 0 :  substr_count($v, '\n') + 1; $xAC063X21['vc'.$x] = ($c == 0)? '' : number_format($c); }  $c = 0; $wr = 0; $s = y76F80Xef('taSource'); if($s != '') { $c = substr_count($s, '\n') + 1; $c -= substr_count($s, '[asset]'); $wr = substr_count($s, '[webroot]'); $c -= $wr; } $xAC063X21['sc'] = ($c == 0)? '' : number_format($c); $xAC063X21['wc'] = ($wr == 0)? '' : number_format($wr); }   function y6aA88X3A($tzone) { global $x0c547X4B, $theAuxDir;  $xAC063X21 = array(); for($x=1; $x<6; $x++) { $xa4666Xxe = array(); if(!empty($x0c547X4B['k'.$x][0])) { $xa4666Xxe = array_unique($x0c547X4B['k'.$x]); } $c = count($xa4666Xxe);  $xAC063X21['pc'.$x] = $c; $xAC063X21['pv'.$x] = implode('\\n', $xa4666Xxe); }  $xAC063X21['tstamp'] = getTimestamp($tzone);  return json_encode($xAC063X21); }    function xCGedbXCx($xaab16cXA) { $xdB78cXdE = 1; while(file_exists($xaab16cXA . $xdB78cXdE)) { $xdB78cXdE++; continue; } return $xaab16cXA . $xdB78cXdE; }   function xfdd2aX04($pc) { file_put_contents($GLOBALS['theAuxDir'].'/pcent',$pc); }   function x60C9cX1b($dir) { $success = false;  if(x3X8daXD2() != 'Windows') { $descriptorspec = array( 0 => array("pipe", "r"), 1 => array("pipe", "w"), 2 => array("pipe", "w") ); $pipes = array();  $process = proc_open("rm -r $dir", $descriptorspec, $pipes); if(is_resource($process)) { proc_close($process); $success = true; } }  if(! $success) _delTree($dir); }  function _delTree($dir) { foreach(scandir($dir) as $file) { if ('.' === $file || '..' === $file) continue; if (is_dir("$dir/$file")) _delTree("$dir/$file"); else unlink("$dir/$file"); } rmdir($dir); }  function fatalErrorHandler() { $xecD116Xx = error_get_last(); if($xecD116Xx['type'] === E_ERROR) { $msg = $xecD116Xx['message']; $xF0F1beXf = preg_match('/allowed memory.* (\d+) .*exhausted/i',$msg,$xbBe124X9); if($xF0F1beXf == 1) { $n = number_format(intval($xbBe124X9[1])); $msg = "Allowed memory size of $n bytes exhausted."; } $xAC063X21 = array(); $xAC063X21['status'] = 'memory'; $xAC063X21['msg'] = $msg; echo json_encode($xAC063X21); } }  $xC1c131X5;  function xdfG133Xa($from) { $url = str_replace(' ','%20',$from); $x0b37eX86 = curl_init($url); curl_setopt($x0b37eX86, CURLOPT_HEADER, 0); curl_setopt($x0b37eX86, CURLOPT_RETURNTRANSFER, 1); curl_setopt($x0b37eX86, CURLOPT_FOLLOWLOCATION, 1); $xF0F1beXf = curl_exec($x0b37eX86); $err = curl_errno($x0b37eX86); curl_close($x0b37eX86); if($xF0F1beXf) return $xF0F1beXf; if($err != 60) return false; header("location: http://masspagecreator.com/ck/errpage.php?cmd=cert"); exit(); }  function xGB8bfX7x() { global $theSname; $xd12134XE = new PclZip('credentials.zip'); if(($ar = $xd12134XE->listContent()) == 0) return; if(count($ar) != 1) return; if($ar[0]['filename'] != $theSname) return;  $x1ee68XE4 = $xd12134XE->extract(PCLZIP_OPT_BY_NAME, $theSname, PCLZIP_OPT_EXTRACT_AS_STRING,PCLZIP_OPT_REPLACE_NEWER); if(!empty($x1ee68XE4)) { $x7xE1c8XB = $x1ee68XE4[0]['content']; file_put_contents($theSname,$x7xE1c8XB); $_SESSION['yxec9XxDG'] = 'no'; } }   function xEA9a0XxF() { global $theAuxDir,$VER,$xC1c131X5; if(! TESTING) { if((DEBUG) && (strlen($VER) < 5)) { $xF0F1beXf = xdfG133Xa('http://masspagecreator.com/ck/bin/debug/cab'.$VER.'.zip'); } else { $xF0F1beXf = xdfG133Xa('http://masspagecreator.com/ck/auto/cabs/cab'.$VER.'.zip'); } if(!$xF0F1beXf) { header('location: https://masspagecreator.com/ck/errpage.php?cmd=fileservercab&parm1='.$_SERVER['HTTP_HOST'].$x53C1c9X0 = $_SERVER['REQUEST_URI']); exit(); } file_put_contents($theAuxDir.'/cab'.$VER.'.zip', $xF0F1beXf); $zip = new PclZip($theAuxDir.'/cab'.$VER.'.zip'); $zip->extract(PCLZIP_OPT_PATH, "$theAuxDir",PCLZIP_OPT_REPLACE_NEWER); unlink($theAuxDir.'/cab'.$VER.'.zip'); $zip = new PclZip($theAuxDir.'/aws.zip'); $zip->extract(PCLZIP_OPT_PATH, "$theAuxDir",PCLZIP_OPT_REPLACE_NEWER); unlink($theAuxDir.'/aws.zip');  $iterator = new RecursiveIteratorIterator(new RecursiveDirectoryIterator("$theAuxDir/bin")); foreach($iterator as $item) { chmod($item, 0755); } } }   function y20ad4XXc($cj) { global $theAuxDir;  $patt = "/\\.min\\.$cj\$/"; $DIR = opendir("$theAuxDir/$cj"); while($f = readdir($DIR)) { if(preg_match($patt ,$f) == 1) unlink("$theAuxDir/$cj/$f"); } closedir($DIR); return; }   function errorHandler($x396b8X09, $x0F0baXb2, $x5d1b6XC2, $x37Bb7X7F) { switch ($x396b8X09) { case E_USER_ERROR: xXbf161Xx('[T]',$x0F0baXb2,$x5d1b6XC2,$x37Bb7X7F); return true; break;  case E_WARNING: xXbf161Xx('[W]',$x0F0baXb2,$x5d1b6XC2,$x37Bb7X7F); return true; break;  case E_ERROR: xXbf161Xx('[E]',$x0F0baXb2,$x5d1b6XC2,$x37Bb7X7F); return false; break; default: return false; }        }  function xXbf161Xx($type,$x0F0baXb2,$x5d1b6XC2,$x37Bb7X7F) { global $theAuxDir; $x2CGaeX00 = date('m.d.Y H:i:s'); $msg = "$x2CGaeX00 $type $x0F0baXb2 in $x5d1b6XC2 [$x37Bb7X7F]";  $xD6G3eXaE = array(); if(file_exists("$theAuxDir/mpcerr_log")) $xD6G3eXaE = file("$theAuxDir/mpcerr_log"); $xD6G3eXaE[] = $msg."\n"; $xAd461XbC = count($xD6G3eXaE);  if($xAd461XbC > 500) $xD6G3eXaE = array_slice($xD6G3eXaE, $xAd461XbC-100); file_put_contents("$theAuxDir/mpcerr_log", $xD6G3eXaE); }   function xEF610eX2($path) { global $theFname,$theSname,$theZname,$theAuxDir;  $pro = array( strtolower($theFname), strtolower($theSname), strtolower($theZname), strtolower($theAuxDir), 'mpc-asset.php', 'mpc_short_files', 'jquery.1.11.2.min.js', 'credentials.zip' );  $ar = explode('/',$path); $xx916fXFe = false; foreach($ar as $xfF0135XX) { if(in_array(strtolower($xfF0135XX),$pro)) { $xx916fXFe = true; break; } } if($xx916fXFe) return $xfF0135XX; else return ""; }   function x9Ea10fX6($path) { global $theFnameFld;  $dir = trim(pathinfo($path,PATHINFO_DIRNAME),'/ '); $ar = explode('/',$dir); if($ar[0] == '.' || $ar == '..') array_shift($ar); if(empty($ar)) return ""; if(strtolower($ar[0]) == strtolower($theFnameFld)) return $dir.'/'; return ""; }   function x76F80Xef() { if( (isset($_GET['isfile'])) && (isset($_GET['fn'])) ) { if($_GET['isfile'] == 1) { echo (file_exists($_GET['fn']))? 'yes' : 'no'; exit; } } }   function xE0F82XFb() { if(isset($_GET['checkurl'])) { if($_GET['checkurl'] == 1) { echo 'ok'; exit; } } }   function xc9E81X9b() { if(isset($_GET['logout'])) { if( ($_GET['logout'] == 1) || ($_GET['logout'] == 2) ) { session_start(); session_unset(); session_destroy(); $_SESSION = array(); } } }   function checkIfUpdated() { if( isset($_GET['v']) ) { session_start(); session_unset(); session_destroy(); $_SESSION = array(); } }   function xcAc83X77(&$ar) { global $pver;  $ar = array( 'v5.3' => 0,    'v5.5' => 0,    'v5.5.10' => 0  );  list($xE09123XA,$xCa3127Xx,$release) = explode('.', phpversion()); $v = "$xE09123XA.$xCa3127Xx";   $pver = "$xE09123XA$xCa3127Xx";  if($xE09123XA > 5) { $ar['v5.3'] = 1; $ar['v5.5'] = 1; $ar['v5.5.10'] = 1; return $v; } if( ($xE09123XA < 5) || ($xCa3127Xx < 3) ) { header("location: https://masspagecreator.com/ck/errpage.php?cmd=not53&parm1=$v"); exit(); } $ar['v5.3'] = 1;  if($xCa3127Xx > 4) $ar['v5.5'] = 1;  if( $xCa3127Xx > 5) $ar['v5.5.10'] = 1;  else if( ($xCa3127Xx == 5) && ($release > 9) ) $ar['v5.5.10'] = 1;  return $v; }   function diskSpace() { if(! file_exists('/HOSIXY')) return 'no';  $dbytes = disk_free_space('../'); $si_prefix = array( 'B', 'KB', 'MB', 'GB', 'TB', 'EB', 'ZB', 'YB' ); $base = 1024; $class = min((int)log($dbytes , $base) , count($si_prefix) - 1); return sprintf('%1.2f' , $dbytes / pow($base,$class)) . ' ' . $si_prefix[$class]; }   function x1Ba104X0() { umask(022); set_time_limit(0); ini_set('max_execution_time', "0"); ini_set('html_errors', "0"); ini_set('ignore_repeated_errors', "1"); if(preg_match('/(\d+)([mg])/i', ini_get('memory_limit'), $m) == 1) { $mg = strtolower($m[2]); if( (($mg == 'm') && ($m[1] < 2048)) || (($mg == 'g') && ($m[1] < 2)) ) ini_set('memory_limit', '2048M'); } }   function ye7f0k77d() { if(! function_exists("json_encode")) { header('location: https://masspagecreator.com/ck/errpage.php?cmd=noJson'); exit(); } }   function xaff84XxX() { if(! function_exists("curl_init")) { header('location: https://masspagecreator.com/ck/errpage.php?cmd=noCurl'); exit(); } }   function x4D8cX045($xD541c6Xe) { if(!file_exists($xD541c6Xe)) {    $xA951c1X0 = xdfG133Xa('https://masspagecreator.com/ck/pclzip/pclzip.lib.php.txt'); if(!$xA951c1X0) { header('location: https://masspagecreator.com/ck/errpage.php?cmd=fileserverpcl&parm1='.$_SERVER['HTTP_HOST'].$x53C1c9X0 = $_SERVER['REQUEST_URI']); exit(); } else { file_put_contents($xD541c6Xe, $xA951c1X0); } } if(file_exists('pclzip.lib.php')) unlink('pclzip.lib.php'); }   function x4D9cX045() { $jfile = 'jquery.1.11.2.min.js'; if(!file_exists($jfile)) {    $xA951c1X0 = xdfG133Xa('https://masspagecreator.com/ck/pclzip/'.$jfile); if(!$xA951c1X0) { header('location: https://masspagecreator.com/ck/errpage.php?cmd=fileserverjs&parm1='.$_SERVER['HTTP_HOST'].$x53C1c9X0 = $_SERVER['REQUEST_URI']); exit(); } else { file_put_contents($jfile, $xA951c1X0); } } }   function xBG3109XB() { if(!isset($_GET['wpress'])) return 0; if($_GET['wpress'] != 1) return 0;  $x0Ef71XGC = 0; if(isset($_GET['bPlugin']) ) { if($_GET['bPlugin'] == 1) $x0Ef71XGC = 1; } if($x0Ef71XGC == 0) { header('location: https://masspagecreator.com/ck/errpage.php?cmd=oldwp'); exit(); } return 1; } function x150b4Xf3($s) { $i = hexdec(substr($s,0,1)); return substr($s,0,$i+1).str_rot13(substr($s,$i+1,14)).substr($s,$i+15); }   function x59e179XE() { if(! file_exists('.htaccess')) { file_put_contents('.htaccess', "IndexIgnore *\n"); } else { $ht = file_get_contents('.htaccess'); $pos = stripos($ht, 'IndexIgnore'); if($pos === false) { $ht .= "\nIndexIgnore *\n"; file_put_contents('.htaccess', $ht); } } }   function xbG9106X5() { global $theAuxDir, $ht_qetrigger, $ht_dowp;  $ar_new = array( 'perpage' => 100, 'tzone' => 'gmt', 'culldays' => 14, 'cullticks' => 0, 'dosort' => 1,   'sepw' => 0,     'dowp' => 0,     'cb_ts' => 1, 'force_ssl' => 0,  'init_ed_src' => 0,  'legacy_prj' => 0,  'conf_del' => 1,  'conf_ovr' => 1, 'anim'     => 1, 'qetrigger' => 'double', 'exlist'   => 'css js jpg gif png', 'theme'    => 'gray', 'dia_build_html' => 1, 'dia_build_tgz'  => 0 ); if(file_exists("$theAuxDir/settings")) { $xDce62Xee = json_decode( file_get_contents("$theAuxDir/settings"), true); foreach($xDce62Xee as $k => $v) { if(($k == 'theme')&&($v == 'custom')) continue; if(($k == 'tzone')&&(substr($v, 0, 2) == '+-')) continue; $ar_new[$k] = $v; } } $ht_qetrigger = $ar_new['qetrigger']; $ht_dowp = $ar_new['dowp'];      file_put_contents("$theAuxDir/settings", json_encode($ar_new)); chmod("$theAuxDir/settings", 0644); return $ar_new['theme']; }   function y20D8aX50($j) { global $theAuxDir;  $ar_new = json_decode($j, true); $ar_old = json_decode(file_get_contents("$theAuxDir/settings"), true); foreach($ar_new as $k => $v) { $ar_old[$k] = $v; } file_put_contents("$theAuxDir/settings", json_encode($ar_old)); chmod("$theAuxDir/settings", 0644); }    function yfdd2aX04() { global $theAuxDir; $x74265XB7 = array( 'SIG' => 'MassPageCreator Ftp', 'NAME' => '', 'ftphost' => '', 'ftpuser' => '', 'ftppass' => '', 'ftpdomain' => '', 'ftpport' => '21', 'ftproot' => 'public_html', 'ftpmdir' => 'mpc' ); if(file_exists("$theAuxDir/ftpsettings.php")) { require_once "$theAuxDir/ftpsettings.php"; $xDce62Xee = json_decode( $ftpjstr, true); foreach($xDce62Xee as $k => $v) { $x74265XB7[$k] = $v; } } $xd8d114X9  = json_encode($x74265XB7); file_put_contents("$theAuxDir/ftpsettings.php", "<?php\n\$ftpjstr = '".$xd8d114X9."';\n?>\n"); chmod("$theAuxDir/ftpsettings.php", 0644); }   function yfdGd6XXE() { global $theAuxDir; $x74265XB7 = array( 'api' => '', 'w' => '420', 'h' => '315', 'chan' => '', 'keyw' => '', 'auto' => '0', 'loop' => '0', 'full' => '0', 'bg' => '1', 'wp' => '0', 'hp' => '0' ); if(file_exists("$theAuxDir/utsettings.php")) { $xDce62Xee = json_decode( file_get_contents("$theAuxDir/utsettings.php"), true); foreach($xDce62Xee as $k => $v) { $x74265XB7[$k] = $v; } } file_put_contents( "$theAuxDir/utsettings.php", json_encode($x74265XB7) ); chmod("$theAuxDir/utsettings.php", 0644); }   function initYelpSettingsFile3() { }  function initGmSettingsFile() { }  function initGpSettingsFile() { }   function initYelpSettingsFile() { global $theAuxDir; $x74265XB7 = array( 'ck' => '', 'cs' => '', 'tk' => '', 'ts' => '', 'city' => '', 'state' => '', 'zip' => '', 'term' => '', 'limit' => '5'  ); if(file_exists("$theAuxDir/yelpsettings.php")) { $xDce62Xee = json_decode( file_get_contents("$theAuxDir/yelpsettings.php"), true); foreach($xDce62Xee as $k => $v) { $x74265XB7[$k] = $v; } } file_put_contents( "$theAuxDir/yelpsettings.php", json_encode($x74265XB7) ); chmod("$theAuxDir/yelpsettings.php", 0644); }   function initSiSettingsFile() { global $theAuxDir; $x74265XB7 = array( 'si_columns'      => '4', 'si_case'         => 't', 'si_class'        => 'silo-',  'si_width'        => '100', 'yn_pcent'        => '1', 'yn_nowrap'       => '0', 'si_bgnd_color'   => 'FFFFFF',  'si_txt_align'    => 'center', 'si_hpadding'     => '4', 'si_vpadding'     => '0', 'si_spacing'      => '4',  'si_link_ok'      => '1', 'si_font_size'    => '10pt', 'si_link_color'   => '0000FF', 'si_hover_color'  => '0000FF',  'si_brd_size'     => '1', 'si_brd_collapse' => '0', 'si_brd_type'     => 'solid', 'si_brd_color'    => '000000',  'si_pre_color'    => 'FFFFFF',  'cb_style'        => '1', 'cb_short'        => '1',  'yn_hide0'        => '0', 'yn_hide1'        => '0', 'yn_hide2'        => '0', 'yn_hide3'        => '0' ); if(file_exists("$theAuxDir/sisettings")) { $xDce62Xee = json_decode( file_get_contents("$theAuxDir/sisettings"), true); foreach($xDce62Xee as $k => $v) { $x74265XB7[$k] = $v; } } $xd8d114X9  = json_encode($x74265XB7); file_put_contents("$theAuxDir/sisettings", $xd8d114X9); chmod("$theAuxDir/sisettings", 0644); }   function xb5f105Xx() { global $theAuxDir; $x74265XB7 = array( 'smap_yn'          => 'yes',   'smap_follow_yn'   => 'yes',   'lowurl_yn'        => 'no',    'smap_prefix'      => 'mpc',   'smap_remote_yn'   => 'no',    'smap_remote_url'  => '' ); if(file_exists("$theAuxDir/jsettings")) { $xDce62Xee = json_decode( file_get_contents("$theAuxDir/jsettings"), true); foreach($xDce62Xee as $k => $v) { $x74265XB7[$k] = $v; } } $xd8d114X9  = json_encode($x74265XB7); file_put_contents("$theAuxDir/jsettings", $xd8d114X9); chmod("$theAuxDir/jsettings", 0644); }   function ybGCd7X1X() { global $theAuxDir; $x74265XB7 = array(  'email_address' => '', 'api_key'       => '',  'confidence_level'     => 'medium', 'nested_spintax'       => 'false', 'auto_sentences'       => 'false', 'auto_paragraphs'      => 'false', 'auto_new_paragraphs'  => 'false', 'auto_sentence_trees'  => 'false', 'use_only_synonyms'    => 'false', 'auto_protected_terms' => 'false', 'protected_terms'      => '' ); if(file_exists("$theAuxDir/spinsettings.php")) { require_once "$theAuxDir/spinsettings.php"; $xDce62Xee = json_decode( $spinjstr, true); foreach($xDce62Xee as $k => $v) { $x74265XB7[$k] = $v; } } $xd8d114X9  = json_encode($x74265XB7); file_put_contents("$theAuxDir/spinsettings.php", "<?php\n\$spinjstr = '".$xd8d114X9."';\n?>\n"); chmod("$theAuxDir/spinsettings.php", 0644); }   function y0X2d8Xe0() { global $theAuxDir; $x74265XB7 = array(  'username' => '', 'password' => '',  'superspun1'     => '0', 'superspun2'     => '0', 'lsireplacement' => '0', 'paracount'      => '0', 'spintogether'   => '0', 'count'          => '2', 'category'       => '0', 'wordcount'      => '300' ); if(file_exists("$theAuxDir/artsettings.php")) { require_once "$theAuxDir/artsettings.php"; $xDce62Xee = json_decode( $artjstr, true); foreach($xDce62Xee as $k => $v) { $x74265XB7[$k] = $v; } } $xd8d114X9  = json_encode($x74265XB7); file_put_contents("$theAuxDir/artsettings.php", "<?php\n\$artjstr = '".$xd8d114X9."';\n?>\n"); chmod("$theAuxDir/artsettings.php", 0644); }   function initS3SettingsFile() { global $theAuxDir;  $x74265XB7 = array( 'key' => '', 'secret' => '', 'region' => 'us-east-1', 'wbucket' => '' ); if(file_exists("$theAuxDir/s3settings.php")) { require_once "$theAuxDir/s3settings.php"; $xDce62Xee = json_decode( $s3jstr, true); foreach($xDce62Xee as $k => $v) { $x74265XB7[$k] = $v; } } $xd8d114X9  = json_encode($x74265XB7); file_put_contents("$theAuxDir/s3settings.php", "<?php\n\$s3jstr = '".$xd8d114X9."';\n?>\n"); chmod("$theAuxDir/s3settings.php", 0644); }   function initPxSettingsFile() { global $theAuxDir; $x74265XB7 = array( 'city' => '', 'region' => '', 'country' => 'US', 'radius' => 20, 'mkm' => 'm', 'dest' => 0, 'itarget' => 0, 'popmm' => 'min', 'poplim' => '', 'pop' => 0, 'formula' => 0, 'auto' => 0, 'fpath' => 0, 'silo' => 0, 'folder' => 0, 'locase' => 0  ); if(file_exists("$theAuxDir/pxsettings.php")) { require_once "$theAuxDir/pxsettings.php"; $xDce62Xee = json_decode( $pxjstr, true); foreach($xDce62Xee as $k => $v) { $x74265XB7[$k] = $v; } } $xd8d114X9  = json_encode($x74265XB7); file_put_contents("$theAuxDir/pxsettings.php", "<?php\n\$pxjstr = '".$xd8d114X9."';\n?>\n"); chmod("$theAuxDir/pxsettings.php", 0644); }   function x3X8daXD2() { $_SESSION['yAx4fXcX0'] = php_uname('r'); $xaDx1aaX6 = php_uname('s').' '.php_uname('m'); $xdcX11eXa = strtolower(trim($xaDx1aaX6)); if(substr($xdcX11eXa,0,3) == 'win') $xaDx1aaX6 = 'Windows'; if(substr($xdcX11eXa,0,6) == 'darwin') $xaDx1aaX6 = 'Mac'; return $xaDx1aaX6; }   function xAxC173Xe($fname,$xx85188XA) { global $theAuxDir; $dir = pathinfo($theAuxDir.'/tmp/'.$fname,PATHINFO_DIRNAME); if(! file_exists($dir)) mkdir($dir,0777,true); file_put_contents($theAuxDir.'/tmp/'.$fname, $xx85188XA); }  function DEBUG($msg,$file = './DEBUG') { $xcf35XCFE = fopen($file,'ab'); fwrite($xcf35XCFE,$msg,strlen($msg)); fwrite($xcf35XCFE,"\n",1); fclose($xcf35XCFE); } function ARDEBUG($msg,$xAC063X21,$file = './DEBUG') { $msg .= "\n".print_r($xAC063X21,true); $xcf35XCFE = fopen($file,'ab'); fwrite($xcf35XCFE,$msg,strlen($msg)); fwrite($xcf35XCFE,"\n",1); fclose($xcf35XCFE); }  function TFDEBUG($msg,$xAf5193Xf,$file = './DEBUG') { $xF0F1beXf = ($xAf5193Xf)? 'true':'false'; $msg .= $xF0F1beXf; $xcf35XCFE = fopen($file,'ab'); fwrite($xcf35XCFE,$msg,strlen($msg)); fwrite($xcf35XCFE,"\n",1); fclose($xcf35XCFE); } require_once($theAuxDir.'/html.php'); ?>
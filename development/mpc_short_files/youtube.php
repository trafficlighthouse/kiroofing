<?php  parse_str($mpc_qdata, $_mpc_ar);  $_mpc_vid = ''; $_mpc_data  = 'part=id'; $_mpc_data .= '&type=video'; $_mpc_data .= '&videoEmbeddable=true'; $_mpc_data .= '&maxResults=12'; $_mpc_data .= '&fields=items/id'; $_mpc_data .= '&key='.rawurlencode(str_rot13($_mpc_ar['ak'])); $_mpc_data .= '&q='.rawurlencode($_mpc_ar['keyw']); if(strlen($_mpc_ar['chan']) > 2) { $_mpc_data .= '&channelId='.rawurlencode($_mpc_ar['chan']); }  $_mpc_ch = curl_init('https://www.googleapis.com/youtube/v3/search?'.$_mpc_data); curl_setopt($_mpc_ch, CURLOPT_HEADER, 0); curl_setopt($_mpc_ch, CURLOPT_RETURNTRANSFER, 1); $_mpc_response = trim(curl_exec($_mpc_ch)); curl_close($_mpc_ch);  try { $_mpc_ut = json_decode($_mpc_response); if( isset($_mpc_ut->items[0]->id->videoId) ) { $_mpc_cnt = count($_mpc_ut->items); $_mpc_vid = $_mpc_ut->items[rand(0,$_mpc_cnt-1)]->id->videoId; } } catch(Exception $e) { $_mpc_vid = ''; } echo "//www.youtube.com/embed/".$_mpc_vid."?autoplay=".$_mpc_ar['auto']."&loop=".$_mpc_ar['loop']; ?>